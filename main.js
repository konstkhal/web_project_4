!function(){"use strict";class e{constructor(e,t,s,i,r){var n,o;o=()=>this._cardTemplate.cloneNode(!0),(n="_getTemplate")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this._cardSelector=t,this._id=e._id,this._ownerId=e.owner._id,this._userId=e.user_id,this._likesCount=e.likes.length,this._likesList=e.likes,this._cardTemplate=this._cardSelector.content.querySelector(".photo-grid__item"),this._handleTrashButtonClick=i,this._handleCardClick=s,this._handleLikeButtonClick=r,this._name=e.namePlace,this._link=e.linkPlace,this._alt="Picture of ".concat(e.namePlace)}_setEventListeners(){this._cardLikeButtonElement.addEventListener("click",(e=>this._handleLikeButtonClick(this._id))),this._cardTrashButtonElement.addEventListener("click",(()=>this._handleTrashButtonClick(this._id))),this._cardImageElement.addEventListener("click",(()=>this._handleCardClick()))}getIsLiked(){return this._isLiked()}updateLikes(e){this._likesList=e,this._renderLikes()}_isLiked(){return this._likesList.some((e=>e._id===this._userId))}_renderLikes(){const e=this._likesList.length;this._cardLikesCounterElement.textContent=e,this._isLiked()?this._cardLikeButtonElement.classList.add("photo-grid__like-button_active"):this._cardLikeButtonElement.classList.remove("photo-grid__like-button_active")}generateCard(){return this._element=this._getTemplate(),this._cardTitleElement=this._element.querySelector(".photo-grid__title"),this._cardImageElement=this._element.querySelector(".photo-grid__image"),this._cardLikeButtonElement=this._element.querySelector(".photo-grid__like-button"),this._cardTrashButtonElement=this._element.querySelector(".photo-grid__delete-button"),this._cardLikesCounterElement=this._element.querySelector(".photo-grid__likes-counter"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._ownerId!==this._userId&&this._element.querySelector(".photo-grid__delete-button").remove(),this._renderLikes(),this._element}removeCard(){this._element.remove(),this._element=null}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var s=class{constructor(e,s){t(this,"_setEventListeners",(()=>{this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._сheckInputValidity(e),this._toggleButton()}))}))})),t(this,"_showInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._config.errorClass),e.classList.add(this._config.inputErrorClass)})),t(this,"_hideInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass)})),t(this,"_сheckInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),this._config={...e},this._element=s,this._buttonElement=this._element.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._element.querySelectorAll(this._config.inputSelector))}_toggleButton(){this._hasValidInputs()?this._buttonElement.disabled=!1:this._buttonElement.disabled=!0}_hasValidInputs(){return this._inputList.every((e=>!0===e.validity.valid))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._element.reset(),this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()}};const i={inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"button_blocked",inputErrorClass:"form__input-error",errorClass:"form__input-error_visible"},r=document.querySelector(".profile__link-change_place_profile"),n=document.querySelector(".profile__link-add"),o=document.querySelector(".profile__link-change_place_image"),a=document.querySelector(".form__input_type_name"),l=".profile__role",c=(document.querySelector(l),document.querySelector(".form__input_type_role"));document.querySelector(".form__input_type_image-title"),document.querySelector(".form__input_type_image-link");class h{constructor(e){var t,s;s=e=>{"Escape"===e.key&&(e.preventDefault(),this.close())},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}}class u extends h{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__submit-button"),this.handleFormSubmit=t,this._inputsArray=[...this._popupForm.querySelectorAll(".form__input")]}renderLoading(e){e?(this._submitButton.textContent="Saving...",this._submitButton.disabled=!0):(this._submitButton.textContent="Save",this._submitButton.disabled=!1)}getPopupForm(){return this._popupForm}_getInputValues(){const e={};return this._inputsArray.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this.handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}const _=document.querySelector("#card-template");let d;const p=t=>{const s=new e(t,_,(()=>{E.open(t.linkPlace,t.namePlace)}),(e=>{k.open();try{k.setAction((()=>{k.renderLoading(!0),m.deleteCard(e).then((e=>{s.removeCard(),k.close()}))}))}catch(e){console.log(e)}k.renderLoading(!1)}),(e=>{s.getIsLiked()?m.disLikeCard(e).then((e=>{s.updateLikes(e.likes)})):m.likeCard(e).then((e=>{s.updateLikes(e.likes)}))}));return s.generateCard()},m=new class{constructor(e){let{baseUrl:t,headers:s}=e;var i,r;r=async(e,t)=>{const s=await fetch(e,t);return s.ok?s.json():Promise.reject(s.statusText)},(i="_customFetch")in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,this._baseUrl=t,this._headers=s}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setAvatarLink(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}setUserInfo(e){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}createCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}disLikeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"cfbd7707-a110-44ae-8aa8-630296f53c66","Content-Type":"application/json"}}),b=new class{constructor(e,t){let{items:s,renderer:i}=e;var r,n;n=e=>{this.container.prepend(e)},(r="addItem")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this.renderer=i,this.container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this.addItem(this.renderer(e))}))}}({items:[],renderer:p},".photo-grid__list");m.getUserInfo().then((e=>{g.setUserInfo({profileFormNameInput:e.name,profileFormRoleInput:e.about,avatarLink:e.avatar})}));try{Promise.all([m.getInitialCards(),m.getUserInfo()]).then((e=>{let[t,s]=e;d=s._id;const i=[];t.forEach((e=>{const t={createdAt:e.createdAt,namePlace:e.name,_id:e._id,linkPlace:e.link,owner:e.owner,likes:e.likes,user_id:d};i.push(t)})),b.renderItems(i)}))}catch(e){console.log(e)}const g=new class{constructor(e,t,s){return this._nameSelector=e,this._jobSelector=t,this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(s),this}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.profileFormNameInput,this._jobElement.textContent=e.profileFormRoleInput,this._avatar.alt="Image of ".concat(e.profileFormNameInput),this._avatar.src=e.avatarLink}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__name",l,".profile__photo"),v=new u(".popup_type_edit-profile",(function(e){v.renderLoading(!0);try{m.setUserInfo({name:e.profileFormNameInput,about:e.profileFormRoleInput}).then((e=>{g.setUserInfo({profileFormNameInput:e.name,profileFormRoleInput:e.about,avatarLink:e.avatar}),v.close()}))}catch(e){console.log(e)}v.renderLoading(!1)})),f=new u(".popup_type_new-card",(function(e){f.renderLoading(!0);try{m.createCard({name:e.namePlace,link:e.linkPlace}).then((e=>{b.addItem(p({namePlace:e.name,linkPlace:e.link,_id:e._id,owner:e.owner,user_id:d,likes:e.likes}))})),f.close()}catch{console.log(err)}f.renderLoading(!1)})),L=new u(".popup_type_avatar-change",(function(e){L.renderLoading(!0);const t=e.name;try{m.setAvatarLink(t).then((e=>{g.setUserAvatar(e),L.close()}))}catch(e){console.log(e)}L.renderLoading(!1)})),E=new class extends h{constructor(e){var t,s;super(e),s=(e,t)=>{this._previewPopupImage.src=e,this._previewPopupImage.alt="Picture of ".concat(t),this._previewPopupDescription.textContent=t,super.open()},(t="open")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this.open=s,this._previewPopupImage=this._popupElement.querySelector(".popup__preview-image"),this._previewPopupDescription=this._popupElement.querySelector(".popup__description")}}(".popup_type_preview"),k=new class extends h{setAction(e){this._handleSubmit=e,this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__submit-button")}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}renderLoading(e){e?(this._submitButton.textContent="Deleting...",this._submitButton.disabled=!0):(this._submitButton.textContent="Yes",this._submitButton.disabled=!1)}}(".popup_type_confirm-delete-card"),y=new s(i,f.getPopupForm()),I=new s(i,v.getPopupForm()),C=new s(i,L.getPopupForm());y.enableValidation(),I.enableValidation(),C.enableValidation(),E.setEventListeners(),v.setEventListeners(),f.setEventListeners(),k.setEventListeners(),L.setEventListeners(),r.addEventListener("click",(()=>{v.open(),I.resetValidation(),function(e){let{name:t,job:s}=e;a.value=t,c.value=s}(g.getUserInfo())})),n.addEventListener("click",(()=>{f.open(),y.resetValidation()})),o.addEventListener("click",(()=>{L.open(),C.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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azovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBUcmFuc2Zvcm1pbmcgdGhlIENhcmQgQ2xhc3NcclxuICogIENvbm5lY3QgdGhlIENhcmQgY2xhc3MgdG8gdGhlIHBvcHVwLlxyXG4gKiBNYWtlIENhcmQgdGFrZSB0aGUgaGFuZGxlQ2FyZENsaWNrKCkgZnVuY3Rpb24gaW50byB0aGUgY29uc3RydWN0b3IuXHJcbiAqIFdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIHRoZSBjYXJkLFxyXG4gKiB0aGlzIGZ1bmN0aW9uIHdpbGwgb3BlbiB0aGUgcG9wdXAgd2l0aCBhbiBpbWFnZVxyXG4gKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZVRyYXNoQnV0dG9uQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjsgLy90ZW1wbGF0ZSBzZWxlY3RvclxyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIC8vY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSBkYXRhLnVzZXJfaWQ7XHJcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9saWtlc0xpc3QgPSBkYXRhLmxpa2VzO1xyXG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLl9saWtlc0xpc3QpO1xyXG5cclxuICAgIC8vY29uc29sZS5sb2codGhpcy5fbGlrZXNDb3VudCk7XHJcbiAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID1cclxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1ncmlkX19pdGVtXCIpOyAvLyBzZWxlY3RpbmcgY2FyZCB0ZW1wbGF0ZSBlbGVtZW50XHJcblxyXG4gICAgdGhpcy5faGFuZGxlVHJhc2hCdXR0b25DbGljayA9IGhhbmRsZVRyYXNoQnV0dG9uQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2sgPSBoYW5kbGVMaWtlQnV0dG9uQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZVBsYWNlO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGlua1BsYWNlO1xyXG4gICAgdGhpcy5fYWx0ID0gYFBpY3R1cmUgb2YgJHtkYXRhLm5hbWVQbGFjZX1gO1xyXG5cclxuICAgIC8vIHNlbGVjdCBjYXJkIGFuZCBjYXJkIGVsZW1lbnQgcGFydHNcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9oYW5kbGVycyBzZXR0ZWQgaGVyZVxyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGljayh0aGlzLl9pZClcclxuICAgICk7XHJcbiAgICB0aGlzLl9jYXJkVHJhc2hCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaEJ1dHRvbkNsaWNrKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qICBfaGFuZGxlTGlrZUJ1dHRvbkNsaWNrID0gKGUpID0+IHtcclxuICAgIC8vY29uc29sZS5sb2coZXZlbnQpO1xyXG4gICAgZS50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcInBob3RvLWdyaWRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9OyAqL1xyXG5cclxuICAvKiAgIF9oYW5kbGVUcmFzaEJ1dHRvbkNsaWNrID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07ICovXHJcblxyXG4gIC8qICBfaGFuZGxlQ2FyZEltYWdlQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xyXG4gIH07ICovXHJcblxyXG4gIGdldElzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZCgpO1xyXG4gIH1cclxuXHJcbiAgLyogcmVuZGVyTGlrZShuZXdMaWtlcykge1xyXG4gICAgLy9jb25zb2xlLmxvZyhuZXdMaWtlcyk7XHJcbiAgICB0aGlzLl9saWtlc0xpc3QgPSBuZXdMaWtlcztcclxuICAgIHRoaXMuX2xpa2VzQ291bnQgPSBuZXdMaWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tZ3JpZF9fbGlrZXMtY291bnRlclwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX2xpa2VzQ291bnQ7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgXCJwaG90by1ncmlkX19saWtlLWJ1dHRvbl9hY3RpdmVcIlxyXG4gICAgKTtcclxuXHJcbiAgICAvLyB0aGlzLl9saWtlc0NvdW50ID0gbmV3TGlrZXMubGVuZ3RoO1xyXG4gIH0gKi9cclxuXHJcbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcclxuICAgIC8vIHNldCBpbnN0YW5jZSB2YXJpYWJsZVxyXG4gICAgdGhpcy5fbGlrZXNMaXN0ID0gbGlrZXM7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgX2lzTGlrZWQoKSB7XHJcbiAgICAvLyByZXR1cm4gdHJ1ZSBpZiB1c2VyIGxpa2VkIHRoZSBjYXJkLCBvdGhlcndpc2UgZmFsc2VcclxuICAgIHJldHVybiB0aGlzLl9saWtlc0xpc3Quc29tZSgocGVyc29uKSA9PiBwZXJzb24uX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgY29uc3QgbGlrZXNDb3VudCA9IHRoaXMuX2xpa2VzTGlzdC5sZW5ndGg7XHJcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyRWxlbWVudC50ZXh0Q29udGVudCA9IGxpa2VzQ291bnQ7XHJcblxyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICBcInBob3RvLWdyaWRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiXHJcbiAgICAgICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcclxuICAgICAgICBcInBob3RvLWdyaWRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tZ3JpZF9fdGl0bGVcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1ncmlkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucGhvdG8tZ3JpZF9fbGlrZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRUcmFzaEJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBob3RvLWdyaWRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucGhvdG8tZ3JpZF9fbGlrZXMtY291bnRlclwiXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgaWYgKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tZ3JpZF9fZGVsZXRlLWJ1dHRvblwiKS5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiAgICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5yZW5kZXJMaWtlKHRoaXMuX2xpa2VzTGlzdCk7XHJcbiAgICB9Ki9cclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICAvL3RoaXMuX2NhcmRMaWtlc0NvdW50ZXJFbGVtZW50LnRleHRDb250ZW50ID0gbGlrZXNDb3VudDtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbCkge1xuICAgIHRoaXMuX2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG5cbiAgICB0aGlzLl9lbGVtZW50ID0gZm9ybUVsOyAvL215IGZvcm0gaXMgaGVyZVxuXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dHMoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBfaGFzVmFsaWRJbnB1dHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkID09PSB0cnVlKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5f0YFoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XG4gICAgY29uc3QgZXJyb3JTcGFuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcblxuICAgIGVycm9yU3Bhbi50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yU3Bhbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IGVycm9yU3BhbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG5cbiAgICBlcnJvclNwYW4udGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yU3Bhbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF/RgWhlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0KSA9PiB7XG4gICAgaWYgKGlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9XG4gIH07XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAvL1B1YmxpYyBpbml0IGVudHJ5IHBvaW50IG9mIHRoZSBjbGFzc1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVzZXQoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9KTtcbiAgICAvLyB0aGlzLl9lbGVtZW50LnJlc2V0KCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNvbnN0IGRlZmF1bHRGb3JtQ29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImJ1dHRvbl9ibG9ja2VkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl92aXNpYmxlXCIsXHJcbiAgLy8gZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbn07XHJcblxyXG5jb25zdCBwb3B1cE9wZW5FZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fbGluay1jaGFuZ2VfcGxhY2VfcHJvZmlsZVwiXHJcbik7XHJcbmNvbnN0IG5ld0NhcmRCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19saW5rLWFkZFwiKTtcclxuXHJcbmNvbnN0IHBvcHVwT3BlbkVkaXRBdmF0YXJMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19saW5rLWNoYW5nZV9wbGFjZV9pbWFnZVwiXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgIElOSVRJQUwgdmFyaWFibGVzIGZvciBwcm9maWxlIGVkaXQgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBuYW1lRWxlbWVudFNlbGVjdG9yID0gXCIucHJvZmlsZV9fbmFtZVwiO1xyXG4vL2NvbnN0IG5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxlbWVudFNlbGVjdG9yKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF90eXBlX25hbWVcIik7IC8vcG9wdXAgZm9ybVxyXG5jb25zdCByb2xlRWxlbWVudFNlbGVjdG9yID0gXCIucHJvZmlsZV9fcm9sZVwiO1xyXG5jb25zdCByb2xlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iocm9sZUVsZW1lbnRTZWxlY3Rvcik7XHJcbmNvbnN0IHJvbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9yb2xlXCIpO1xyXG5jb25zdCBhdmF0YXJFbGVtZW50U2VsZWN0b3IgPSBcIi5wcm9maWxlX19waG90b1wiO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICBQb3B1cCBBREQgY2FyZCBmdW5jdGlvbmFsaXR5ICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgdXNlcklucHV0SW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuZm9ybV9faW5wdXRfdHlwZV9pbWFnZS10aXRsZVwiXHJcbik7XHJcbmNvbnN0IHVzZXJJbnB1dEltYWdlTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuZm9ybV9faW5wdXRfdHlwZV9pbWFnZS1saW5rXCJcclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICBFc2NhcGUga2V5IHZhbHVlIENPTlNUICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgRVNDX0JVVFRPTiA9IFwiRXNjYXBlXCI7XHJcblxyXG5leHBvcnQge1xyXG4gIEVTQ19CVVRUT04sXHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgcG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgbmV3Q2FyZEJ1dHRvbkVsZW1lbnQsXHJcbiAgcG9wdXBPcGVuRWRpdEF2YXRhckxpbmssXHJcbiAgbmFtZUlucHV0LFxyXG4gIHJvbGVJbnB1dCxcclxuICBuYW1lRWxlbWVudFNlbGVjdG9yLFxyXG4gIHJvbGVFbGVtZW50U2VsZWN0b3IsXHJcbiAgdXNlcklucHV0SW1hZ2VUaXRsZSxcclxuICB1c2VySW5wdXRJbWFnZUxpbmssXHJcbiAgYXZhdGFyRWxlbWVudFNlbGVjdG9yLFxyXG59O1xyXG4iLCJpbXBvcnQgeyBFU0NfQlVUVE9OIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyBQb3B1cCBvcGVucyBhbmQgY2xvc2VzIHRoZSBwb3B1cCB3aW5kb3dcclxuICogYXMgcGVyIHRoZSBmb2xsb3dpbmcgcmVxdWlyZW1lbnRzOlxyXG4gKiBAY29uc3RydWN0b3IgaGFzIGEgc2luZ2xlXHJcbiAqIEBwYXJhbSBwb3B1cFNlbGVjdG9yIGl0IGlzIHRoZSBwb3B1cCBzZWxlY3Rvci5cclxuICogSXQgc3RvcmVzIHRoZVxyXG4gKiBwdWJsaWMgQG1ldGhvZCBvcGVuKCkgdGhhdCB3aWxsIG9wZW4gdGhlIHBvcHVwLlxyXG4gKiBwdWJsaWMgQG1ldGhvZCBjbG9zZSgpIHRoYXQgd2lsbCBjbG9zZSB0aGUgcG9wdXAuXHJcbiAqIEl0IHN0b3JlcyBhXHJcbiAqIHByaXZhdGUgQG1ldGhvZCBfaGFuZGxlRXNjQ2xvc2UoKSB0aGF0IHByZXZlbnRzIGRlZmF1bHRcclxuICogYW5kIHN0b3JlcyB0aGUgbG9naWMgZm9yICAqIGNsb3NpbmcgdGhlIHBvcHVwIGJ5IHByZXNzaW5nIHRoZSBFc2Mga2V5LlxyXG4gKiBJdCBzdG9yZXMgYVxyXG4gKiBwdWJsaWMgQG1ldGhvZCBzZXRFdmVudExpc3RlbmVycygpIHRoYXQgYWRkcyBhIGNsaWNrIGV2ZW50IGxpc3RlbmVyXHJcbiAqICB0byB0aGUgY2xvc2UgaWNvbiBvZiB0aGUgcG9wdXAuIFRoZSBtb2RhbCB3aW5kb3cgc2hvdWxkIGFsc29cclxuICogY2xvc2Ugd2hlbiB1c2VycyBjbGljayBvbiB0aGUgc2hhZGVkIGFyZWEgYXJvdW5kIHRoZSBmb3JtLlxyXG4gKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgLy8gdGhpcy5zZXRFdmVudExpc3RlbmVycyA9IHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMuYmluZCh0aGlzKTtcclxuICAgIC8vUmVzZXJ2ZWQgZm9yIGZ1dHVyZSB1c2U6IHNvbHV0aW9uIGZvciBub3QgbG9zaW5nIGNvbnRleFxyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpIHx8XHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZS1idXR0b25cIilcclxuICAgICAgICAvLyB8fCAhZXZlbnQuY2xvc2VzdChcInBvcHVwXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgLy9kZWJ1Z2dlcjtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gRVNDX0JVVFRPTikge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgUG9wdXBXaXRoRm9ybSBhcyBhIGNoaWxkIGNsYXNzIG9mIFBvcHVwLlxyXG4gKiBUaGUgUG9wdXBXaXRoRm9ybSBjbGFzcyBtdXN0IGNvbXBseSB3aXRoIHRoZSBmb2xsb3dpbmcgcmVxdWlyZW1lbnRzOlxyXG4gKiBJdCB0YWtlcyB0d28gYXJndW1lbnRzOlxyXG4gKiB0aGUgcG9wdXAgc2VsZWN0b3IsXHJcbiAqIGFuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uXHJcbiAqIHdoaWNoIFBvcHVwV2l0aGdpdCBybSBjYWxscyB3aGVuIHRoZSBmb3Jt4oCZcyBzdWJtaXQgZXZlbnQgZmlyZXMuXHJcbiAqIEl0IHN0b3JlcyBhIHByaXZhdGUgbWV0aG9kIG5hbWVkIF9nZXRJbnB1dFZhbHVlcygpLFxyXG4gKiB3aGljaCBjb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdC5cclxuICogSXQgbW9kaWZpZXMgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgcGFyZW50IG1ldGhvZC5cclxuICogVGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhGb3JtIGNsYXNzXHJcbiAqICBoYXMgdG8gYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybTBcclxuICogIGFuZCB0aGUgY2xpY2sgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24uXHJcbiAqIEl0IG1vZGlmaWVzIHRoZSBjbG9zZSgpIHBhcmVudCBtZXRob2RcclxuICogaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxyXG4gKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcblxyXG4gICAgLy9jb25zb2xlLmxvZyh0aGlzLl9zdWJtaXRCdXR0b25UZXh0KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiKTtcclxuICAgIC8vY29uc29sZS5sb2codGhpcy5fc3VibWl0QnV0dG9uKTtcclxuICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dHNBcnJheSA9IFsuLi50aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XHJcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMuX2lucHV0c0FycmF5KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRQb3B1cEZvcm0oKSB7XHJcbiAgICAvL2NvbnNvbGUubG9nKHRoaXMuX3BvcHVwRm9ybSk7XHJcbiAgICByZXR1cm4gdGhpcy5fcG9wdXBGb3JtO1xyXG4gIH1cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRzQXJyYXkuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIC8qICAgdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiKS5pbm5lckhUTUwgPVxyXG4gICAgICAgIFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQpOyAqL1xyXG4gICAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIC8vICAgICAgc2V0VGltZW91dCgxMDAwMDApO1xyXG4gICAgICAvKiAgICAgICB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCIpLmlubmVySFRNTCA9XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dDsgKi9cclxuICAgICAgLy8gdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICB9XHJcbn1cclxuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYWluIHNjcmlwdHMgZmlsZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEltcG9ydHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXRcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XHJcbi8vaW1wb3J0IHsgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NhcmRzLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgcG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgbmV3Q2FyZEJ1dHRvbkVsZW1lbnQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIHJvbGVJbnB1dCxcclxuICBuYW1lRWxlbWVudFNlbGVjdG9yLFxyXG4gIHJvbGVFbGVtZW50U2VsZWN0b3IsXHJcbiAgcG9wdXBPcGVuRWRpdEF2YXRhckxpbmssXHJcbiAgYXZhdGFyRWxlbWVudFNlbGVjdG9yLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyYXBwZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4vLyBzZWxlY3RpbmcgY2FyZCB0ZW1wbGF0ZSBlbGVtZW50XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjbGFyYXRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbi8qKlxyXG4gKiBAZnVuY3Rpb24gcmVuZGVyQ2FyZCBjcmVhdGVzIENhcmQgb2JqZWN0IHdpdGggZGF0YSBwYXJhbSBhbmQgd2l0aCB0ZW1wbGF0ZSBoYXJkY29kZWRcclxuICogQHBhcmFtIHthcnJheX0gZGF0YSBjb250YWlucyB7bmFtZSwgbGlua31cclxuICogQHBhcmFtIHt0ZXh0fSBjYXJkVGVtcGxhdGVFbGVtZW50IGNvbnRhaW5zIHRleHQgaWQgb2YgY2FyZCBlbGVtZW50IHRvIGJlIGNsb25lZFxyXG4gKiBAcGFyYW0ge0Fycm93IGZ1bmN0aW9ufSBpcyBjYXJkQ2xpY2sgaGFuZGxlciBmb3Igb3BlbmluZyBQb3B1cFdpdGhJbWFnZVxyXG4gKi9cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRUZW1wbGF0ZUVsZW1lbnQsXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGltYWdlUG9wdXAub3BlbihkYXRhLmxpbmtQbGFjZSwgZGF0YS5uYW1lUGxhY2UpO1xyXG4gICAgfSxcclxuICAgIChpZCkgPT4ge1xyXG4gICAgICBjb25maXJtTW9kYWwub3BlbigpO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbmZpcm1Nb2RhbC5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgICAgY29uZmlybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbmZpcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0sXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgY29uc3QgaXNBbHJlYWR5TGlrZWQgPSBjYXJkLmdldElzTGlrZWQoKTtcclxuICAgICAgaWYgKGlzQWxyZWFkeUxpa2VkKSB7XHJcbiAgICAgICAgYXBpLmRpc0xpa2VDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGkubGlrZUNhcmQoaWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn07XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImNmYmQ3NzA3LWExMTAtNDRhZS04YWE4LTYzMDI5NmY1M2M2NlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBjYXJkTGlzdFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7IGl0ZW1zOiBbXSwgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSxcclxuICBcIi5waG90by1ncmlkX19saXN0XCJcclxuKTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgIHByb2ZpbGVGb3JtTmFtZUlucHV0OiByZXMubmFtZSxcclxuICAgIHByb2ZpbGVGb3JtUm9sZUlucHV0OiByZXMuYWJvdXQsXHJcbiAgICBhdmF0YXJMaW5rOiByZXMuYXZhdGFyLFxyXG4gIH0pO1xyXG4gIC8vY29uc29sZS5sb2coXCJyZXNcIiwgcmVzKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGRhdGEpIHtcclxuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBjb25zdCB1c2VyRGF0YSA9IGRhdGEubmFtZTtcclxuICB0cnkge1xyXG4gICAgLy8gYXBpIHJlcXVlc3RcclxuICAgIGFwaS5zZXRBdmF0YXJMaW5rKHVzZXJEYXRhKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgLy8gdXBkYXRlIGRhdGFcclxuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMpO1xyXG4gICAgICAvLyBjbG9zZSBwb3B1cCBpZiBuZWNlc3NhcnlcclxuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIC8vIHByb2Nlc3MgZXJyb3JcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfVxyXG4gIC8vIGhpZGUgbG9hZGluZ1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxufVxyXG5cclxudHJ5IHtcclxuICBQcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pLnRoZW4oXHJcbiAgICAoW2NhcmREYXRhLCB1c2VyRGF0YV0pID0+IHtcclxuICAgICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgICBjb25zdCBjYXJkcyA9IFtdO1xyXG4gICAgICBjYXJkRGF0YS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgZW50cnkgPSB7XHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IGVsZW1lbnQuY3JlYXRlZEF0LFxyXG4gICAgICAgICAgbmFtZVBsYWNlOiBlbGVtZW50Lm5hbWUsXHJcbiAgICAgICAgICBfaWQ6IGVsZW1lbnQuX2lkLFxyXG4gICAgICAgICAgbGlua1BsYWNlOiBlbGVtZW50LmxpbmssXHJcbiAgICAgICAgICBvd25lcjogZWxlbWVudC5vd25lcixcclxuICAgICAgICAgIGxpa2VzOiBlbGVtZW50Lmxpa2VzLFxyXG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2FyZHMucHVzaChlbnRyeSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY2FyZExpc3RTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcclxuICAgICAgLyogIHsgaXRlbXM6IGNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gICAgICBcIi5waG90by1ncmlkX19saXN0XCJcclxuICAgICk7ICovXHJcbiAgICB9XHJcbiAgKTtcclxufSBjYXRjaCAoZXJyKSB7XHJcbiAgLy8gcHJvY2VzcyBlcnJvclxyXG4gIGNvbnNvbGUubG9nKGVycik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGRhdGEpIHtcclxuICAvLyBzaG93IGxvYWRpbmdcclxuICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgdHJ5IHtcclxuICAgIC8vIGFwaSByZXF1ZXN0XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lOiBkYXRhLnByb2ZpbGVGb3JtTmFtZUlucHV0LFxyXG4gICAgICAgIGFib3V0OiBkYXRhLnByb2ZpbGVGb3JtUm9sZUlucHV0LFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgLy8gdXBkYXRlIGRhdGFcclxuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgICBwcm9maWxlRm9ybU5hbWVJbnB1dDogcmVzLm5hbWUsXHJcbiAgICAgICAgICBwcm9maWxlRm9ybVJvbGVJbnB1dDogcmVzLmFib3V0LFxyXG4gICAgICAgICAgYXZhdGFyTGluazogcmVzLmF2YXRhcixcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBjbG9zZSBwb3B1cCBpZiBuZWNlc3NhcnlcclxuICAgICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9XHJcbiAgLy8gaGlkZSBsb2FkaW5nXHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZEZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIC8vIHNob3cgbG9hZGluZ1xyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIHRyeSB7XHJcbiAgICAvLyBhcGkgcmVxdWVzdFxyXG4gICAgYXBpXHJcbiAgICAgIC5jcmVhdGVDYXJkKHsgbmFtZTogZGF0YS5uYW1lUGxhY2UsIGxpbms6IGRhdGEubGlua1BsYWNlIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAvLyB1cGRhdGUgZGF0YVxyXG4gICAgICAgIGNhcmRMaXN0U2VjdGlvbi5hZGRJdGVtKFxyXG4gICAgICAgICAgcmVuZGVyQ2FyZCh7XHJcbiAgICAgICAgICAgIG5hbWVQbGFjZTogcmVzLm5hbWUsXHJcbiAgICAgICAgICAgIGxpbmtQbGFjZTogcmVzLmxpbmssXHJcbiAgICAgICAgICAgIF9pZDogcmVzLl9pZCxcclxuICAgICAgICAgICAgb3duZXI6IHJlcy5vd25lcixcclxuICAgICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICAgICAgICBsaWtlczogcmVzLmxpa2VzLFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICB9KTtcclxuICAgIC8vIGNsb3NlIHBvcHVwIGlmIG5lY2Vzc2FyeVxyXG4gICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICAvLyBwcm9jZXNzIGVycm9yXHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH1cclxuICAvLyBoaWRlIGxvYWRpbmcgfVxyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxufVxyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgbmFtZUVsZW1lbnRTZWxlY3RvcixcclxuICByb2xlRWxlbWVudFNlbGVjdG9yLFxyXG4gIGF2YXRhckVsZW1lbnRTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgaGFuZGxlRWRpdEZvcm1TdWJtaXRcclxuKTtcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiLFxyXG4gIGhhbmRsZU5ld0NhcmRGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX2F2YXRhci1jaGFuZ2VcIixcclxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGVfcHJldmlld1wiKTtcclxuY29uc3QgY29uZmlybU1vZGFsID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cF90eXBlX2NvbmZpcm0tZGVsZXRlLWNhcmRcIik7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxyXG4gIGFkZENhcmRQb3B1cC5nZXRQb3B1cEZvcm0oKVxyXG4pO1xyXG5jb25zdCBlZGl0Rm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxyXG4gIGVkaXRQcm9maWxlUG9wdXAuZ2V0UG9wdXBGb3JtKClcclxuKTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgZWRpdEF2YXRhclBvcHVwLmdldFBvcHVwRm9ybSgpXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICBQb3B1cCBFbmFibGUgVmFsaWRhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuYWRkQ2FyZEZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5lZGl0Rm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRBdmF0YXJGb3JtLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgIFBvcHVwIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uZmlybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICBPcGVuIFBvcHVwIEJ1dHRvbnMgbGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKHsgbmFtZSwgam9iIH0pIHtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHJvbGVJbnB1dC52YWx1ZSA9IGpvYjtcclxufVxyXG5cclxucG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBlZGl0Rm9ybS5yZXNldFZhbGlkYXRpb24oKTtcclxuXHJcbiAgZmlsbFByb2ZpbGVGb3JtKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG59KTtcclxuXHJcbm5ld0NhcmRCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICBhZGRDYXJkRm9ybS5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5wb3B1cE9wZW5FZGl0QXZhdGFyTGluay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgZWRpdEF2YXRhckZvcm0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuICBfY3VzdG9tRmV0Y2ggPSBhc3luYyAodXJsLCBoZWFkZXJzKSA9PiB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgaGVhZGVycyk7XHJcbiAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5zdGF0dXNUZXh0KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAvKiAgICAgY29uc29sZS5sb2coXHJcbiAgICAgIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwgeyBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzIH0pXHJcbiAgICApOyAqL1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiAgZ2V0QXZhdGFyTGluaygpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9ICovXHJcblxyXG4gIHNldEF2YXRhckxpbmsoZGF0YSkge1xyXG4gICAgLy9jb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGRhdGEgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRpc0xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG59XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGUgdGhlIFNlY3Rpb24gY2xhc3MgZm9yIHJlbmRlcmluZyBhIGxpc3Qgb2YgZWxlbWVudHMgb24gYSBwYWdlXHJcbiAqIGFjY29yZGluZyB0byB0aGUgZm9sbG93aW5nIHJlcXVpcmVtZW50czpcclxuICogSXQgaGFzIGFuIG9iamVjdCB3aXRoIHR3byBwcm9wZXJ0aWVzIChpdGVtcyBhbmQgcmVuZGVyZXIpXHJcbiAqIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIgb2YgdGhlIGNvbnN0cnVjdG9yLlxyXG4gKiBUaGUgaXRlbXMgcHJvcGVydHkgc2VydmVzIGFzIGFuIGFycmF5IG9mIGRhdGEsXHJcbiAqIHdoaWNoIHlvdSBuZWVkIHRvIGFkZCBvbiBhIHBhZ2Ugd2hlbiBpbml0aWFsaXppbmcgdGhlIGNsYXNzLlxyXG4gKiBUaGUgcmVuZGVyZXIgcHJvcGVydHkgaXMgYVxyXG4gKiBmdW5jdGlvbiByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgYW5kIHJlbmRlcmluZyBkYXRhIG9uIGEgcGFnZS5cclxuICogVGhlIHNlY29uZCBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgQ1NTIGNsYXNzIHNlbGVjdG9yXHJcbiAqIHdoZXJlIHlvdSdsbCBhZGQgdGhlIGNhcmQgZWxlbWVudHMuXHJcbiAqIEl0IHN0b3JlcyBhIHB1YmxpYyBtZXRob2QgdGhhdCByZW5kZXJzIGFsbCBlbGVtZW50cyBvbiB0aGUgcGFnZS5cclxuICogVGhlIHJlbmRlcmVyKCkgZnVuY3Rpb24gd2lsbCByZW5kZXIgZWFjaCBlbGVtZW50IG9uIGEgcGFnZS5cclxuICogSXQgc3RvcmVzIGEgcHVibGljIG1ldGhvZCBuYW1lZCBhZGRJdGVtKClcclxuICogdGhhdCB0YWtlcyBhIERPTSBlbGVtZW50IGFuZCBhZGRzIGl0IHRvIHRoZSBjb250YWluZXIuXHJcbiAqIFRoZSBTZWN0aW9uIGNsYXNzIGRvZXNuJ3QgaGF2ZSBtYXJrdXAuXHJcbiAqIEl0IHJlY2VpdmVzIG1hcmt1cCB0aHJvdWdoIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBhbmQgaW5zZXJ0cyBpdCBpbiB0aGUgY29udGFpbmVyXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgLy90aGlzLmluaXRpYWxJdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIC8vICAgdGhpcy5yZW5kZXJJdGVtcygpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5hZGRJdGVtKHRoaXMucmVuZGVyZXIoaXRlbSkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtID0gKGVsZW1lbnQpID0+IHtcclxuICAgIC8vIGNvbnNvbGUubG9nKGVsZW1lbnQpO1xyXG4gICAgdGhpcy5jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9O1xyXG59XHJcbiIsIi8qKlRoZSBVc2VySW5mbyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3JcclxuICogcmVuZGVyaW5nIGluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VyIG9uIHRoZSBwYWdlLlxyXG4gKiBUaGlzIGNsYXNzIHNob3VsZDpcclxuICogVGFrZSBhbiBvYmplY3Qgd2l0aCB0aGUgc2VsZWN0b3JzIG9mIHR3byBlbGVtZW50cyBpbnRvIHRoZSBjb25zdHJ1Y3RvcjpcclxuICogb25lIGNvbnRhaW5pbmcgdGhlIHVzZXIncyBuYW1lLFxyXG4gKiBhbmQgYW5vdGhlciBjb250YWluaW5nIHRoZSB1c2VyJ3Mgam9iLlxyXG4gKiBTdG9yZSBhIHB1YmxpYyBtZXRob2QgbmFtZWQgZ2V0VXNlckluZm8oKSxcclxuICogd2hpY2ggcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlci5cclxuICogVGhpcyBtZXRob2Qgd2lsbCBiZSBoYW5keSBmb3IgY2FzZXMgd2hlbiBpdCdzIG5lY2Vzc2FyeSB0byBkaXNwbGF5IHRoZSB1c2VyIGRhdGEgaW4gdGhlIG9wZW4gZm9ybS5cclxuICogU3RvcmUgYSBwdWJsaWMgbWV0aG9kIG5hbWVkIHNldFVzZXJJbmZvKCksXHJcbiAqIHdoaWNoIHRha2VzIG5ldyB1c2VyIGRhdGEgYW5kIGFkZHMgaXQgb24gdGhlIHBhZ2UuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lU2VsZWN0b3IgPSBuYW1lU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9qb2JTZWxlY3RvciA9IGpvYlNlbGVjdG9yO1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzKTtcclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGluZm8pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gaW5mby5wcm9maWxlRm9ybU5hbWVJbnB1dDtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgPSBpbmZvLnByb2ZpbGVGb3JtUm9sZUlucHV0O1xyXG4gICAgdGhpcy5fYXZhdGFyLmFsdCA9IGBJbWFnZSBvZiAke2luZm8ucHJvZmlsZUZvcm1OYW1lSW5wdXR9YDtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBpbmZvLmF2YXRhckxpbms7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuLyoqXHJcbiAqIEBjbGFzcyBQb3B1cFdpdGhJbWFnZSBhIGNoaWxkIEBjbGFzcyBvZiBQb3B1cC5cclxuICogVGhpcyBjbGFzcyBoYXMgdG8gY2hhbmdlIHRoZSBAcGFyZW50IG9wZW4oKSBAbWV0aG9kLlxyXG4gKiBUaGUgQG1ldGhvZCBvcGVuKCkgb2YgdGhlIFBvcHVwV2l0aEltYWdlIEBjbGFzcywgYWRkcyBhbiBpbWFnZSB0byB0aGUgcG9wdXBcclxuICogYW5kIHRoZSBjb3JyZXNwb25kaW5nIGltYWdlIHNyYyBhdHRyaWJ1dGUgYWxvbmcgd2l0aCBhIGNhcHRpb24gZm9yIHRoZSBpbWFnZS5cclxuICpcclxuICogUHV0cyBcIm5hbWVcIiBmcm9tIEBhcmd1bWVudHMgdG8gdGhlIFwiLnBvcHVwX19jYXB0aW9uXCIgc2VsZWN0b3JcclxuICogZmluZCBpbWFnZSBieSB0aGUgcG9wdXBfX2ltYWdlXCIgc2VsZWN0b3Igc2V0IFwic3JjXCIgYW5kIFwiYWx0XCIgZm9yIGl0XHJcbiAqICBjYWxsIEBjbGFzcyBzdXBlci5vcGVuLCBpdCB3aWxsIGNhbGwgdGhlIG9yaWdpbmFsIEBtZXRob2QgZnJvbSBvcmlnaW5hbCBAY2xhc3MgUG9wdXBcclxuICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3ByZXZpZXdQb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwX19wcmV2aWV3LWltYWdlXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9wcmV2aWV3UG9wdXBEZXNjcmlwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cF9fZGVzY3JpcHRpb25cIlxyXG4gICAgKTtcclxuICB9XHJcbiAgb3BlbiA9IChsaW5rUGxhY2UsIG5hbWVQbGFjZSkgPT4ge1xyXG4gICAgLy8gIGNvbnNvbGUubG9nKGxpbmtQbGFjZSk7XHJcblxyXG4gICAgdGhpcy5fcHJldmlld1BvcHVwSW1hZ2Uuc3JjID0gbGlua1BsYWNlO1xyXG4gICAgdGhpcy5fcHJldmlld1BvcHVwSW1hZ2UuYWx0ID0gYFBpY3R1cmUgb2YgJHtuYW1lUGxhY2V9YDtcclxuICAgIHRoaXMuX3ByZXZpZXdQb3B1cERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gbmFtZVBsYWNlO1xyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9O1xyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZVRyYXNoQnV0dG9uQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJ0aGlzIiwiX2NhcmRUZW1wbGF0ZSIsImNsb25lTm9kZSIsIl9jYXJkU2VsZWN0b3IiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJZCIsInVzZXJfaWQiLCJfbGlrZXNDb3VudCIsImxpa2VzIiwibGVuZ3RoIiwiX2xpa2VzTGlzdCIsImNvbnRlbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZVRyYXNoQnV0dG9uQ2xpY2siLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VCdXR0b25DbGljayIsIl9uYW1lIiwibmFtZVBsYWNlIiwiX2xpbmsiLCJsaW5rUGxhY2UiLCJfYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRMaWtlQnV0dG9uRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiX2NhcmRUcmFzaEJ1dHRvbkVsZW1lbnQiLCJfY2FyZEltYWdlRWxlbWVudCIsImdldElzTGlrZWQiLCJfaXNMaWtlZCIsInVwZGF0ZUxpa2VzIiwiX3JlbmRlckxpa2VzIiwic29tZSIsInBlcnNvbiIsImxpa2VzQ291bnQiLCJfY2FyZExpa2VzQ291bnRlckVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJyZW1vdmVDYXJkIiwiY29uZmlnIiwiZm9ybUVsIiwiX3RvZ2dsZUJ1dHRvbiIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXQiLCJf0YFoZWNrSW5wdXRWYWxpZGl0eSIsImVycm9yU3BhbiIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY29uZmlnIiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfaGFzVmFsaWRJbnB1dHMiLCJkaXNhYmxlZCIsImV2ZXJ5IiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsImRlZmF1bHRGb3JtQ29uZmlnIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInBvcHVwT3BlbkVkaXRQcm9maWxlQnV0dG9uIiwiZG9jdW1lbnQiLCJuZXdDYXJkQnV0dG9uRWxlbWVudCIsInBvcHVwT3BlbkVkaXRBdmF0YXJMaW5rIiwibmFtZUlucHV0Iiwicm9sZUVsZW1lbnRTZWxlY3RvciIsInJvbGVJbnB1dCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbnB1dHNBcnJheSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJnZXRQb3B1cEZvcm0iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsImNhcmRUZW1wbGF0ZUVsZW1lbnQiLCJ1c2VySWQiLCJyZW5kZXJDYXJkIiwiY2FyZCIsImltYWdlUG9wdXAiLCJjb25maXJtTW9kYWwiLCJzZXRBY3Rpb24iLCJhcGkiLCJkZWxldGVDYXJkIiwidGhlbiIsInJlcyIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJkaXNMaWtlQ2FyZCIsImxpa2VDYXJkIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhc3luYyIsInVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJfY3VzdG9tRmV0Y2giLCJnZXRVc2VySW5mbyIsInNldEF2YXRhckxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF2YXRhciIsInNldFVzZXJJbmZvIiwiY3JlYXRlQ2FyZCIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJjYXJkTGlzdFNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJlbGVtZW50IiwiY29udGFpbmVyIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJ1c2VySW5mbyIsInByb2ZpbGVGb3JtTmFtZUlucHV0IiwicHJvZmlsZUZvcm1Sb2xlSW5wdXQiLCJhYm91dCIsImF2YXRhckxpbmsiLCJhbGwiLCJjYXJkRGF0YSIsInVzZXJEYXRhIiwiY2FyZHMiLCJlbnRyeSIsImNyZWF0ZWRBdCIsImxpbmsiLCJwdXNoIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lU2VsZWN0b3IiLCJfam9iU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXIiLCJqb2IiLCJpbmZvIiwic2V0VXNlckF2YXRhciIsImVkaXRQcm9maWxlUG9wdXAiLCJhZGRDYXJkUG9wdXAiLCJlZGl0QXZhdGFyUG9wdXAiLCJfcHJldmlld1BvcHVwSW1hZ2UiLCJfcHJldmlld1BvcHVwRGVzY3JpcHRpb24iLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwiYWRkQ2FyZEZvcm0iLCJGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm0iLCJlZGl0QXZhdGFyRm9ybSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=