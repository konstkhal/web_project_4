!function(){"use strict";class e{constructor(e,t,s,i,r){var n,o;o=()=>this._cardTemplate.cloneNode(!0),(n="_getTemplate")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this._cardSelector=t,this._id=e._id,this._ownerId=e.owner._id,this._userId=e.user_id,this._likesCount=e.likes.length,this._likesList=e.likes,this._cardTemplate=this._cardSelector.content.querySelector(".photo-grid__item"),this._handleTrashButtonClick=i,this._handleCardClick=s,this._handleLikeButtonClick=r,this._name=e.namePlace,this._link=e.linkPlace,this._alt="Picture of ".concat(e.namePlace)}_setEventListeners(){this._cardLikeButtonElement.addEventListener("click",(e=>this._handleLikeButtonClick(this._id))),this._cardTrashButtonElement.addEventListener("click",(()=>this._handleTrashButtonClick(this._id))),this._cardImageElement.addEventListener("click",(()=>this._handleCardClick()))}getIsLiked(){return this._isLiked()}updateLikes(e){this._likesList=e,this._renderLikes()}_isLiked(){return this._likesList.some((e=>e._id===this._userId))}_renderLikes(){const e=this._likesList.length;this._cardLikesCounterElement.textContent=e,this._isLiked()?this._cardLikeButtonElement.classList.add("photo-grid__like-button_active"):this._cardLikeButtonElement.classList.remove("photo-grid__like-button_active")}generateCard(){return this._element=this._getTemplate(),this._cardTitleElement=this._element.querySelector(".photo-grid__title"),this._cardImageElement=this._element.querySelector(".photo-grid__image"),this._cardLikeButtonElement=this._element.querySelector(".photo-grid__like-button"),this._cardTrashButtonElement=this._element.querySelector(".photo-grid__delete-button"),this._cardLikesCounterElement=this._element.querySelector(".photo-grid__likes-counter"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._ownerId!==this._userId&&this._element.querySelector(".photo-grid__delete-button").remove(),this._renderLikes(),this._element}removeCard(){this._element.remove(),this._element=null}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var s=class{constructor(e,s){t(this,"_setEventListeners",(()=>{this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._сheckInputValidity(e),this._toggleButton()}))}))})),t(this,"_showInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._config.errorClass),e.classList.add(this._config.inputErrorClass)})),t(this,"_hideInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass)})),t(this,"_сheckInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),this._config={...e},this._element=s,this._buttonElement=this._element.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._element.querySelectorAll(this._config.inputSelector))}_toggleButton(){this._hasValidInputs()?this._buttonElement.disabled=!1:this._buttonElement.disabled=!0}_hasValidInputs(){return this._inputList.every((e=>!0===e.validity.valid))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._element.reset(),this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()}};const i={inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"button_blocked",inputErrorClass:"form__input-error",errorClass:"form__input-error_visible"},r=document.querySelector(".profile__link-change_place_profile"),n=document.querySelector(".profile__link-add"),o=document.querySelector(".profile__link-change_place_image"),a=document.querySelector(".form__input_type_name"),l=".profile__role",c=(document.querySelector(l),document.querySelector(".form__input_type_role"));document.querySelector(".form__input_type_image-title"),document.querySelector(".form__input_type_image-link");class h{constructor(e){var t,s;s=e=>{"Escape"===e.key&&(e.preventDefault(),this.close())},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}}class u extends h{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__submit-button"),this.handleFormSubmit=t,this._inputsArray=[...this._popupForm.querySelectorAll(".form__input")]}renderLoading(e){e?(this._submitButton.textContent="Saving...",this._submitButton.disabled=!0):(this._submitButton.textContent="Save",this._submitButton.disabled=!1)}getPopupForm(){return this._popupForm}_getInputValues(){const e={};return this._inputsArray.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this.handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._popupForm.reset()}}const _=document.querySelector("#card-template");let d;const p=t=>{const s=new e(t,_,(()=>{E.open(t.linkPlace,t.namePlace)}),(e=>{k.open(),k.setAction((()=>{k.renderLoading(!0),m.deleteCard(e).then((e=>{s.removeCard(),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.renderLoading(!1)}))}))}),(e=>{s.getIsLiked()?m.disLikeCard(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{console.log(e)})):m.likeCard(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{console.log(e)}))}));return s.generateCard()},m=new class{constructor(e){let{baseUrl:t,headers:s}=e;var i,r;r=async(e,t)=>{const s=await fetch(e,t);return s.ok?s.json():Promise.reject(s.statusText)},(i="_customFetch")in this?Object.defineProperty(this,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[i]=r,this._baseUrl=t,this._headers=s}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setAvatarLink(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}setUserInfo(e){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify(e)})}createCard(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}disLikeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"cfbd7707-a110-44ae-8aa8-630296f53c66","Content-Type":"application/json"}}),b=new class{constructor(e,t){let{items:s,renderer:i}=e;var r,n;n=e=>{this.container.prepend(e)},(r="addItem")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this.renderer=i,this.container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this.addItem(this.renderer(e))}))}}({items:[],renderer:p},".photo-grid__list");m.getUserInfo().then((e=>{g.setUserInfo({profileFormNameInput:e.name,profileFormRoleInput:e.about,avatarLink:e.avatar})})).catch((e=>{console.log(e)})),Promise.all([m.getInitialCards(),m.getUserInfo()]).then((e=>{let[t,s]=e;d=s._id;const i=[];t.forEach((e=>{const t={createdAt:e.createdAt,namePlace:e.name,_id:e._id,linkPlace:e.link,owner:e.owner,likes:e.likes,user_id:d};i.push(t)})),b.renderItems(i)})).catch((e=>{console.log(e)}));const g=new class{constructor(e,t,s){return this._nameSelector=e,this._jobSelector=t,this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(s),this}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.profileFormNameInput,this._jobElement.textContent=e.profileFormRoleInput,this._avatar.alt="Image of ".concat(e.profileFormNameInput),this._avatar.src=e.avatarLink}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}(".profile__name",l,".profile__photo"),v=new u(".popup_type_edit-profile",(function(e){v.renderLoading(!0),m.setUserInfo({name:e.profileFormNameInput,about:e.profileFormRoleInput}).then((e=>{g.setUserInfo({profileFormNameInput:e.name,profileFormRoleInput:e.about,avatarLink:e.avatar}),v.close()})).catch((e=>{console.log(e)})).finally((()=>{v.renderLoading(!1)}))})),f=new u(".popup_type_new-card",(function(e){f.renderLoading(!0),m.createCard({name:e.namePlace,link:e.linkPlace}).then((e=>{b.addItem(p({namePlace:e.name,linkPlace:e.link,_id:e._id,owner:e.owner,user_id:d,likes:e.likes})),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.renderLoading(!1)}))})),L=new u(".popup_type_avatar-change",(function(e){L.renderLoading(!0);const t=e.name;m.setAvatarLink(t).then((e=>{g.setUserAvatar(e),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderLoading(!1)}))})),E=new class extends h{constructor(e){var t,s;super(e),s=(e,t)=>{this._previewPopupImage.src=e,this._previewPopupImage.alt="Picture of ".concat(t),this._previewPopupDescription.textContent=t,super.open()},(t="open")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this.open=s,this._previewPopupImage=this._popupElement.querySelector(".popup__preview-image"),this._previewPopupDescription=this._popupElement.querySelector(".popup__description")}}(".popup_type_preview"),k=new class extends h{setAction(e){this._handleSubmit=e,this._popupForm=this._popupElement.querySelector(".form"),this._submitButton=this._popupForm.querySelector(".form__submit-button")}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}renderLoading(e){e?(this._submitButton.textContent="Deleting...",this._submitButton.disabled=!0):(this._submitButton.textContent="Yes",this._submitButton.disabled=!1)}}(".popup_type_confirm-delete-card"),y=new s(i,f.getPopupForm()),I=new s(i,v.getPopupForm()),C=new s(i,L.getPopupForm());y.enableValidation(),I.enableValidation(),C.enableValidation(),E.setEventListeners(),v.setEventListeners(),f.setEventListeners(),k.setEventListeners(),L.setEventListeners(),r.addEventListener("click",(()=>{v.open(),I.resetValidation(),function(e){let{name:t,job:s}=e;a.value=t,c.value=s}(g.getUserInfo())})),n.addEventListener("click",(()=>{f.open(),y.resetValidation()})),o.addEventListener("click",(()=>{L.open(),C.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUIsU0FBUyxLQUNoRHVLLEVBQWdCaEcsT0FDaEJ5RyxFQUFlNUgscUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiogVHJhbnNmb3JtaW5nIHRoZSBDYXJkIENsYXNzXG4gKiAgQ29ubmVjdCB0aGUgQ2FyZCBjbGFzcyB0byB0aGUgcG9wdXAuXG4gKiBNYWtlIENhcmQgdGFrZSB0aGUgaGFuZGxlQ2FyZENsaWNrKCkgZnVuY3Rpb24gaW50byB0aGUgY29uc3RydWN0b3IuXG4gKiBXaGVuIHRoZSB1c2VyIGNsaWNrcyBvbiB0aGUgY2FyZCxcbiAqIHRoaXMgZnVuY3Rpb24gd2lsbCBvcGVuIHRoZSBwb3B1cCB3aXRoIGFuIGltYWdlXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVUcmFzaEJ1dHRvbkNsaWNrLFxuICAgIGhhbmRsZUxpa2VCdXR0b25DbGlja1xuICApIHtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7IC8vdGVtcGxhdGUgc2VsZWN0b3JcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IGRhdGEudXNlcl9pZDtcbiAgICB0aGlzLl9saWtlc0NvdW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XG4gICAgdGhpcy5fbGlrZXNMaXN0ID0gZGF0YS5saWtlcztcblxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZSA9XG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3IuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWdyaWRfX2l0ZW1cIik7IC8vIHNlbGVjdGluZyBjYXJkIHRlbXBsYXRlIGVsZW1lbnRcblxuICAgIHRoaXMuX2hhbmRsZVRyYXNoQnV0dG9uQ2xpY2sgPSBoYW5kbGVUcmFzaEJ1dHRvbkNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2sgPSBoYW5kbGVMaWtlQnV0dG9uQ2xpY2s7XG5cbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lUGxhY2U7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGlua1BsYWNlO1xuICAgIHRoaXMuX2FsdCA9IGBQaWN0dXJlIG9mICR7ZGF0YS5uYW1lUGxhY2V9YDtcblxuICAgIC8vIHNlbGVjdCBjYXJkIGFuZCBjYXJkIGVsZW1lbnQgcGFydHNcbiAgfVxuICBfZ2V0VGVtcGxhdGUgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gIH07XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vaGFuZGxlcnMgc2V0dGVkIGhlcmVcblxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uQ2xpY2sodGhpcy5faWQpXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkVHJhc2hCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlVHJhc2hCdXR0b25DbGljayh0aGlzLl9pZClcbiAgICApO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljaygpXG4gICAgKTtcbiAgfVxuXG4gIGdldElzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQoKTtcbiAgfVxuXG4gIHVwZGF0ZUxpa2VzKGxpa2VzKSB7XG4gICAgLy8gc2V0IGluc3RhbmNlIHZhcmlhYmxlXG4gICAgdGhpcy5fbGlrZXNMaXN0ID0gbGlrZXM7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9pc0xpa2VkKCkge1xuICAgIC8vIHJldHVybiB0cnVlIGlmIHVzZXIgbGlrZWQgdGhlIGNhcmQsIG90aGVyd2lzZSBmYWxzZVxuICAgIHJldHVybiB0aGlzLl9saWtlc0xpc3Quc29tZSgocGVyc29uKSA9PiBwZXJzb24uX2lkID09PSB0aGlzLl91c2VySWQpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGNvbnN0IGxpa2VzQ291bnQgPSB0aGlzLl9saWtlc0xpc3QubGVuZ3RoO1xuICAgIHRoaXMuX2NhcmRMaWtlc0NvdW50ZXJFbGVtZW50LnRleHRDb250ZW50ID0gbGlrZXNDb3VudDtcblxuICAgIGlmICh0aGlzLl9pc0xpa2VkKCkpIHtcbiAgICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKFxuICAgICAgICBcInBob3RvLWdyaWRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcbiAgICAgICAgXCJwaG90by1ncmlkX19saWtlLWJ1dHRvbl9hY3RpdmVcIlxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1ncmlkX190aXRsZVwiKTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tZ3JpZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucGhvdG8tZ3JpZF9fbGlrZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5fY2FyZFRyYXNoQnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBob3RvLWdyaWRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLnBob3RvLWdyaWRfX2xpa2VzLWNvdW50ZXJcIlxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1ncmlkX19kZWxldGUtYnV0dG9uXCIpLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8qICAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5yZW5kZXJMaWtlKHRoaXMuX2xpa2VzTGlzdCk7XG4gICAgfSovXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgICAvL3RoaXMuX2NhcmRMaWtlc0NvdW50ZXJFbGVtZW50LnRleHRDb250ZW50ID0gbGlrZXNDb3VudDtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG59XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9jb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuXG4gICAgdGhpcy5fZWxlbWVudCA9IGZvcm1FbDsgLy9teSBmb3JtIGlzIGhlcmVcblxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX2hhc1ZhbGlkSW5wdXRzKCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgX2hhc1ZhbGlkSW5wdXRzKCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCA9PT0gdHJ1ZSk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG5cbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX9GBaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IGVycm9yU3BhbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG5cbiAgICBlcnJvclNwYW4udGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvclNwYW4uY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCBlcnJvclNwYW4gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuXG4gICAgZXJyb3JTcGFuLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvclNwYW4uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgfTtcblxuICBf0YFoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dCkgPT4ge1xuICAgIGlmIChpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfVxuICB9O1xuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgLy9QdWJsaWMgaW5pdCBlbnRyeSBwb2ludCBvZiB0aGUgY2xhc3NcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlc2V0KCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfSk7XG4gICAgLy8gdGhpcy5fZWxlbWVudC5yZXNldCgpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJjb25zdCBkZWZhdWx0Rm9ybUNvbmZpZyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJidXR0b25fYmxvY2tlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxyXG4gIC8vIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG59O1xyXG5cclxuY29uc3QgcG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2xpbmstY2hhbmdlX3BsYWNlX3Byb2ZpbGVcIlxyXG4pO1xyXG5jb25zdCBuZXdDYXJkQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbGluay1hZGRcIik7XHJcblxyXG5jb25zdCBwb3B1cE9wZW5FZGl0QXZhdGFyTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fbGluay1jaGFuZ2VfcGxhY2VfaW1hZ2VcIlxyXG4pO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICBJTklUSUFMIHZhcmlhYmxlcyBmb3IgcHJvZmlsZSBlZGl0ICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgbmFtZUVsZW1lbnRTZWxlY3RvciA9IFwiLnByb2ZpbGVfX25hbWVcIjtcclxuLy9jb25zdCBuYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZUVsZW1lbnRTZWxlY3Rvcik7XHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9uYW1lXCIpOyAvL3BvcHVwIGZvcm1cclxuY29uc3Qgcm9sZUVsZW1lbnRTZWxlY3RvciA9IFwiLnByb2ZpbGVfX3JvbGVcIjtcclxuY29uc3Qgcm9sZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHJvbGVFbGVtZW50U2VsZWN0b3IpO1xyXG5jb25zdCByb2xlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfcm9sZVwiKTtcclxuY29uc3QgYXZhdGFyRWxlbWVudFNlbGVjdG9yID0gXCIucHJvZmlsZV9fcGhvdG9cIjtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgUG9wdXAgQUREIGNhcmQgZnVuY3Rpb25hbGl0eSAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmNvbnN0IHVzZXJJbnB1dEltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX2lucHV0X3R5cGVfaW1hZ2UtdGl0bGVcIlxyXG4pO1xyXG5jb25zdCB1c2VySW5wdXRJbWFnZUxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX2lucHV0X3R5cGVfaW1hZ2UtbGlua1wiXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgRXNjYXBlIGtleSB2YWx1ZSBDT05TVCAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbmNvbnN0IEVTQ19CVVRUT04gPSBcIkVzY2FwZVwiO1xyXG5cclxuZXhwb3J0IHtcclxuICBFU0NfQlVUVE9OLFxyXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxyXG4gIHBvcHVwT3BlbkVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIG5ld0NhcmRCdXR0b25FbGVtZW50LFxyXG4gIHBvcHVwT3BlbkVkaXRBdmF0YXJMaW5rLFxyXG4gIG5hbWVJbnB1dCxcclxuICByb2xlSW5wdXQsXHJcbiAgbmFtZUVsZW1lbnRTZWxlY3RvcixcclxuICByb2xlRWxlbWVudFNlbGVjdG9yLFxyXG4gIHVzZXJJbnB1dEltYWdlVGl0bGUsXHJcbiAgdXNlcklucHV0SW1hZ2VMaW5rLFxyXG4gIGF2YXRhckVsZW1lbnRTZWxlY3RvcixcclxufTtcclxuIiwiaW1wb3J0IHsgRVNDX0JVVFRPTiB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuLyoqXG4gKiBAY2xhc3MgUG9wdXAgb3BlbnMgYW5kIGNsb3NlcyB0aGUgcG9wdXAgd2luZG93XG4gKiBhcyBwZXIgdGhlIGZvbGxvd2luZyByZXF1aXJlbWVudHM6XG4gKiBAY29uc3RydWN0b3IgaGFzIGEgc2luZ2xlXG4gKiBAcGFyYW0gcG9wdXBTZWxlY3RvciBpdCBpcyB0aGUgcG9wdXAgc2VsZWN0b3IuXG4gKiBJdCBzdG9yZXMgdGhlXG4gKiBwdWJsaWMgQG1ldGhvZCBvcGVuKCkgdGhhdCB3aWxsIG9wZW4gdGhlIHBvcHVwLlxuICogcHVibGljIEBtZXRob2QgY2xvc2UoKSB0aGF0IHdpbGwgY2xvc2UgdGhlIHBvcHVwLlxuICogSXQgc3RvcmVzIGFcbiAqIHByaXZhdGUgQG1ldGhvZCBfaGFuZGxlRXNjQ2xvc2UoKSB0aGF0IHByZXZlbnRzIGRlZmF1bHRcbiAqIGFuZCBzdG9yZXMgdGhlIGxvZ2ljIGZvciAgKiBjbG9zaW5nIHRoZSBwb3B1cCBieSBwcmVzc2luZyB0aGUgRXNjIGtleS5cbiAqIEl0IHN0b3JlcyBhXG4gKiBwdWJsaWMgQG1ldGhvZCBzZXRFdmVudExpc3RlbmVycygpIHRoYXQgYWRkcyBhIGNsaWNrIGV2ZW50IGxpc3RlbmVyXG4gKiAgdG8gdGhlIGNsb3NlIGljb24gb2YgdGhlIHBvcHVwLiBUaGUgbW9kYWwgd2luZG93IHNob3VsZCBhbHNvXG4gKiBjbG9zZSB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSBzaGFkZWQgYXJlYSBhcm91bmQgdGhlIGZvcm0uXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAvLyB0aGlzLnNldEV2ZW50TGlzdGVuZXJzID0gdGhpcy5zZXRFdmVudExpc3RlbmVycy5iaW5kKHRoaXMpO1xuICAgIC8vUmVzZXJ2ZWQgZm9yIGZ1dHVyZSB1c2U6IHNvbHV0aW9uIGZvciBub3QgbG9zaW5nIGNvbnRleFxuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZS1idXR0b25cIilcbiAgICAgICAgLy8gfHwgIWV2ZW50LmNsb3Nlc3QoXCJwb3B1cFwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gRVNDX0JVVFRPTikge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuLyoqXG4gKiBDcmVhdGUgUG9wdXBXaXRoRm9ybSBhcyBhIGNoaWxkIGNsYXNzIG9mIFBvcHVwLlxuICogVGhlIFBvcHVwV2l0aEZvcm0gY2xhc3MgbXVzdCBjb21wbHkgd2l0aCB0aGUgZm9sbG93aW5nIHJlcXVpcmVtZW50czpcbiAqIEl0IHRha2VzIHR3byBhcmd1bWVudHM6XG4gKiB0aGUgcG9wdXAgc2VsZWN0b3IsXG4gKiBhbmQgYSBjYWxsYmFjayBmdW5jdGlvblxuICogd2hpY2ggUG9wdXBXaXRoZ2l0IHJtIGNhbGxzIHdoZW4gdGhlIGZvcm3igJlzIHN1Ym1pdCBldmVudCBmaXJlcy5cbiAqIEl0IHN0b3JlcyBhIHByaXZhdGUgbWV0aG9kIG5hbWVkIF9nZXRJbnB1dFZhbHVlcygpLFxuICogd2hpY2ggY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoYXQgZGF0YSBhcyBhbiBvYmplY3QuXG4gKiBJdCBtb2RpZmllcyB0aGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBwYXJlbnQgbWV0aG9kLlxuICogVGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhGb3JtIGNsYXNzXG4gKiAgaGFzIHRvIGFkZCB0aGUgc3VibWl0IGV2ZW50IGhhbmRsZXIgdG8gdGhlIGZvcm0wXG4gKiAgYW5kIHRoZSBjbGljayBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cbiAqIEl0IG1vZGlmaWVzIHRoZSBjbG9zZSgpIHBhcmVudCBtZXRob2RcbiAqIGluIG9yZGVyIHRvIHJlc2V0IHRoZSBmb3JtIG9uY2UgdGhlIHBvcHVwIGlzIGNsb3NlZC5cbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCIpO1xuICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRzQXJyYXkgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIildO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBnZXRQb3B1cEZvcm0oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3BvcHVwRm9ybTtcbiAgfVxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHNBcnJheS5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1haW4gc2NyaXB0cyBmaWxlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1wb3J0cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuLy9pbXBvcnQgeyBpbml0aWFsQ2FyZHMgfSBmcm9tIFwiLi4vdXRpbHMvY2FyZHMuanNcIjtcclxuaW1wb3J0IHtcclxuICBkZWZhdWx0Rm9ybUNvbmZpZyxcclxuICBwb3B1cE9wZW5FZGl0UHJvZmlsZUJ1dHRvbixcclxuICBuZXdDYXJkQnV0dG9uRWxlbWVudCxcclxuICBuYW1lSW5wdXQsXHJcbiAgcm9sZUlucHV0LFxyXG4gIG5hbWVFbGVtZW50U2VsZWN0b3IsXHJcbiAgcm9sZUVsZW1lbnRTZWxlY3RvcixcclxuICBwb3B1cE9wZW5FZGl0QXZhdGFyTGluayxcclxuICBhdmF0YXJFbGVtZW50U2VsZWN0b3IsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JhcHBlcnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIHNlbGVjdGluZyBjYXJkIHRlbXBsYXRlIGVsZW1lbnRcclxuY29uc3QgY2FyZFRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNsYXJhdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuLyoqXHJcbiAqIEBmdW5jdGlvbiByZW5kZXJDYXJkIGNyZWF0ZXMgQ2FyZCBvYmplY3Qgd2l0aCBkYXRhIHBhcmFtIGFuZCB3aXRoIHRlbXBsYXRlIGhhcmRjb2RlZFxyXG4gKiBAcGFyYW0ge2FycmF5fSBkYXRhIGNvbnRhaW5zIHtuYW1lLCBsaW5rfVxyXG4gKiBAcGFyYW0ge3RleHR9IGNhcmRUZW1wbGF0ZUVsZW1lbnQgY29udGFpbnMgdGV4dCBpZCBvZiBjYXJkIGVsZW1lbnQgdG8gYmUgY2xvbmVkXHJcbiAqIEBwYXJhbSB7QXJyb3cgZnVuY3Rpb259IGlzIGNhcmRDbGljayBoYW5kbGVyIGZvciBvcGVuaW5nIFBvcHVwV2l0aEltYWdlXHJcbiAqL1xyXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFRlbXBsYXRlRWxlbWVudCxcclxuICAgICgpID0+IHtcclxuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubGlua1BsYWNlLCBkYXRhLm5hbWVQbGFjZSk7XHJcbiAgICB9LFxyXG4gICAgKGlkKSA9PiB7XHJcbiAgICAgIGNvbmZpcm1Nb2RhbC5vcGVuKCk7XHJcbiAgICAgIGNvbmZpcm1Nb2RhbC5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGVycm9yXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGVuZCBsb2FkaW5nXHJcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgY29uc3QgaXNBbHJlYWR5TGlrZWQgPSBjYXJkLmdldElzTGlrZWQoKTtcclxuICAgICAgaWYgKGlzQWxyZWFkeUxpa2VkKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGlzTGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGVycm9yXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgIH0pIC8qXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGVuZCBsb2FkaW5nXHJcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIH0pICovO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmxpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAvLyBlcnJvclxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICB9KTsgLypcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgLy8gZW5kIGxvYWRpbmdcclxuICAgICAgICAgICAgY29uZmlybU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7ICovXHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG5cclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiY2ZiZDc3MDctYTExMC00NGFlLThhYTgtNjMwMjk2ZjUzYzY2XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmNvbnN0IGNhcmRMaXN0U2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHsgaXRlbXM6IFtdLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gIFwiLnBob3RvLWdyaWRfX2xpc3RcIlxyXG4pO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIHByb2ZpbGVGb3JtTmFtZUlucHV0OiByZXMubmFtZSxcclxuICAgICAgcHJvZmlsZUZvcm1Sb2xlSW5wdXQ6IHJlcy5hYm91dCxcclxuICAgICAgYXZhdGFyTGluazogcmVzLmF2YXRhcixcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgLy8gZXJyb3JcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGNvbnN0IGF2YXRhckRhdGEgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGFwaVxyXG4gICAgLnNldEF2YXRhckxpbmsoYXZhdGFyRGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgLy8gdXBkYXRlIGRhdGFcclxuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMpO1xyXG4gICAgICAvLyBjbG9zZSBwb3B1cCBpZiBuZWNlc3NhcnlcclxuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAvLyBlcnJvclxyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAvLyBlbmQgbG9hZGluZ1xyXG4gICAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKVxyXG4gIC50aGVuKChbY2FyZERhdGEsIHVzZXJEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgY29uc3QgY2FyZHMgPSBbXTtcclxuICAgIGNhcmREYXRhLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgY29uc3QgZW50cnkgPSB7XHJcbiAgICAgICAgY3JlYXRlZEF0OiBlbGVtZW50LmNyZWF0ZWRBdCxcclxuICAgICAgICBuYW1lUGxhY2U6IGVsZW1lbnQubmFtZSxcclxuICAgICAgICBfaWQ6IGVsZW1lbnQuX2lkLFxyXG4gICAgICAgIGxpbmtQbGFjZTogZWxlbWVudC5saW5rLFxyXG4gICAgICAgIG93bmVyOiBlbGVtZW50Lm93bmVyLFxyXG4gICAgICAgIGxpa2VzOiBlbGVtZW50Lmxpa2VzLFxyXG4gICAgICAgIHVzZXJfaWQ6IHVzZXJJZCxcclxuICAgICAgfTtcclxuICAgICAgY2FyZHMucHVzaChlbnRyeSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjYXJkTGlzdFNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgLy8gZXJyb3JcclxuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICB9KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGRhdGEpIHtcclxuICAvLyBzaG93IGxvYWRpbmdcclxuICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gIC8vIGFwaSByZXF1ZXN0XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiBkYXRhLnByb2ZpbGVGb3JtTmFtZUlucHV0LFxyXG4gICAgICBhYm91dDogZGF0YS5wcm9maWxlRm9ybVJvbGVJbnB1dCxcclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIC8vIHVwZGF0ZSBkYXRhXHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBwcm9maWxlRm9ybU5hbWVJbnB1dDogcmVzLm5hbWUsXHJcbiAgICAgICAgcHJvZmlsZUZvcm1Sb2xlSW5wdXQ6IHJlcy5hYm91dCxcclxuICAgICAgICBhdmF0YXJMaW5rOiByZXMuYXZhdGFyLFxyXG4gICAgICB9KTtcclxuICAgICAgLy8gY2xvc2UgcG9wdXAgaWYgbmVjZXNzYXJ5XHJcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIC8vIGVycm9yXHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIC8vIGVuZCBsb2FkaW5nXHJcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZEZvcm1TdWJtaXQoZGF0YSkge1xyXG4gIC8vIHNob3cgbG9hZGluZ1xyXG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5jcmVhdGVDYXJkKHsgbmFtZTogZGF0YS5uYW1lUGxhY2UsIGxpbms6IGRhdGEubGlua1BsYWNlIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIC8vIHVwZGF0ZSBkYXRhXHJcbiAgICAgIGNhcmRMaXN0U2VjdGlvbi5hZGRJdGVtKFxyXG4gICAgICAgIHJlbmRlckNhcmQoe1xyXG4gICAgICAgICAgbmFtZVBsYWNlOiByZXMubmFtZSxcclxuICAgICAgICAgIGxpbmtQbGFjZTogcmVzLmxpbmssXHJcbiAgICAgICAgICBfaWQ6IHJlcy5faWQsXHJcbiAgICAgICAgICBvd25lcjogcmVzLm93bmVyLFxyXG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxyXG4gICAgICAgICAgbGlrZXM6IHJlcy5saWtlcyxcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcblxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAvLyBlcnJvclxyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAvLyBlbmQgbG9hZGluZ1xyXG4gICAgICBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXHJcbiAgbmFtZUVsZW1lbnRTZWxlY3RvcixcclxuICByb2xlRWxlbWVudFNlbGVjdG9yLFxyXG4gIGF2YXRhckVsZW1lbnRTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgaGFuZGxlRWRpdEZvcm1TdWJtaXRcclxuKTtcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiLFxyXG4gIGhhbmRsZU5ld0NhcmRGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX2F2YXRhci1jaGFuZ2VcIixcclxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX3R5cGVfcHJldmlld1wiKTtcclxuY29uc3QgY29uZmlybU1vZGFsID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cF90eXBlX2NvbmZpcm0tZGVsZXRlLWNhcmRcIik7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxyXG4gIGFkZENhcmRQb3B1cC5nZXRQb3B1cEZvcm0oKVxyXG4pO1xyXG5jb25zdCBlZGl0Rm9ybSA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxyXG4gIGVkaXRQcm9maWxlUG9wdXAuZ2V0UG9wdXBGb3JtKClcclxuKTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJGb3JtID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgZWRpdEF2YXRhclBvcHVwLmdldFBvcHVwRm9ybSgpXHJcbik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICBQb3B1cCBFbmFibGUgVmFsaWRhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuYWRkQ2FyZEZvcm0uZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5lZGl0Rm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRBdmF0YXJGb3JtLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgIFBvcHVwIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uZmlybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICBPcGVuIFBvcHVwIEJ1dHRvbnMgbGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKHsgbmFtZSwgam9iIH0pIHtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIHJvbGVJbnB1dC52YWx1ZSA9IGpvYjtcclxufVxyXG5cclxucG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBlZGl0Rm9ybS5yZXNldFZhbGlkYXRpb24oKTtcclxuXHJcbiAgZmlsbFByb2ZpbGVGb3JtKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpO1xyXG59KTtcclxuXHJcbm5ld0NhcmRCdXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICBhZGRDYXJkRm9ybS5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5wb3B1cE9wZW5FZGl0QXZhdGFyTGluay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgZWRpdEF2YXRhckZvcm0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG4gIF9jdXN0b21GZXRjaCA9IGFzeW5jICh1cmwsIGhlYWRlcnMpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgaGVhZGVycyk7XG4gICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgfVxuICB9O1xuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBzZXRBdmF0YXJMaW5rKGRhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGRhdGEgfSksXG4gICAgfSk7XG4gIH1cblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSk7XG4gIH1cblxuICBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICB9KTtcbiAgfVxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICB9KTtcbiAgfVxuXG4gIGRpc0xpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcbn1cbiIsIi8qKlxuICogQ3JlYXRlIHRoZSBTZWN0aW9uIGNsYXNzIGZvciByZW5kZXJpbmcgYSBsaXN0IG9mIGVsZW1lbnRzIG9uIGEgcGFnZVxuICogYWNjb3JkaW5nIHRvIHRoZSBmb2xsb3dpbmcgcmVxdWlyZW1lbnRzOlxuICogSXQgaGFzIGFuIG9iamVjdCB3aXRoIHR3byBwcm9wZXJ0aWVzIChpdGVtcyBhbmQgcmVuZGVyZXIpXG4gKiBhcyB0aGUgZmlyc3QgcGFyYW1ldGVyIG9mIHRoZSBjb25zdHJ1Y3Rvci5cbiAqIFRoZSBpdGVtcyBwcm9wZXJ0eSBzZXJ2ZXMgYXMgYW4gYXJyYXkgb2YgZGF0YSxcbiAqIHdoaWNoIHlvdSBuZWVkIHRvIGFkZCBvbiBhIHBhZ2Ugd2hlbiBpbml0aWFsaXppbmcgdGhlIGNsYXNzLlxuICogVGhlIHJlbmRlcmVyIHByb3BlcnR5IGlzIGFcbiAqIGZ1bmN0aW9uIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyBhbmQgcmVuZGVyaW5nIGRhdGEgb24gYSBwYWdlLlxuICogVGhlIHNlY29uZCBwYXJhbWV0ZXIgc2hvdWxkIGJlIGEgQ1NTIGNsYXNzIHNlbGVjdG9yXG4gKiB3aGVyZSB5b3UnbGwgYWRkIHRoZSBjYXJkIGVsZW1lbnRzLlxuICogSXQgc3RvcmVzIGEgcHVibGljIG1ldGhvZCB0aGF0IHJlbmRlcnMgYWxsIGVsZW1lbnRzIG9uIHRoZSBwYWdlLlxuICogVGhlIHJlbmRlcmVyKCkgZnVuY3Rpb24gd2lsbCByZW5kZXIgZWFjaCBlbGVtZW50IG9uIGEgcGFnZS5cbiAqIEl0IHN0b3JlcyBhIHB1YmxpYyBtZXRob2QgbmFtZWQgYWRkSXRlbSgpXG4gKiB0aGF0IHRha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lci5cbiAqIFRoZSBTZWN0aW9uIGNsYXNzIGRvZXNuJ3QgaGF2ZSBtYXJrdXAuXG4gKiBJdCByZWNlaXZlcyBtYXJrdXAgdGhyb3VnaCB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gYW5kIGluc2VydHMgaXQgaW4gdGhlIGNvbnRhaW5lclxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5hZGRJdGVtKHRoaXMucmVuZGVyZXIoaXRlbSkpO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbSA9IChlbGVtZW50KSA9PiB7XG4gICAgdGhpcy5jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfTtcbn1cbiIsIi8qKlRoZSBVc2VySW5mbyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3JcbiAqIHJlbmRlcmluZyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlciBvbiB0aGUgcGFnZS5cbiAqIFRoaXMgY2xhc3Mgc2hvdWxkOlxuICogVGFrZSBhbiBvYmplY3Qgd2l0aCB0aGUgc2VsZWN0b3JzIG9mIHR3byBlbGVtZW50cyBpbnRvIHRoZSBjb25zdHJ1Y3RvcjpcbiAqIG9uZSBjb250YWluaW5nIHRoZSB1c2VyJ3MgbmFtZSxcbiAqIGFuZCBhbm90aGVyIGNvbnRhaW5pbmcgdGhlIHVzZXIncyBqb2IuXG4gKiBTdG9yZSBhIHB1YmxpYyBtZXRob2QgbmFtZWQgZ2V0VXNlckluZm8oKSxcbiAqIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuXG4gKiBUaGlzIG1ldGhvZCB3aWxsIGJlIGhhbmR5IGZvciBjYXNlcyB3aGVuIGl0J3MgbmVjZXNzYXJ5IHRvIGRpc3BsYXkgdGhlIHVzZXIgZGF0YSBpbiB0aGUgb3BlbiBmb3JtLlxuICogU3RvcmUgYSBwdWJsaWMgbWV0aG9kIG5hbWVkIHNldFVzZXJJbmZvKCksXG4gKiB3aGljaCB0YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IG9uIHRoZSBwYWdlLlxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lU2VsZWN0b3IgPSBuYW1lU2VsZWN0b3I7XG4gICAgdGhpcy5fam9iU2VsZWN0b3IgPSBqb2JTZWxlY3RvcjtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKGluZm8pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGluZm8ucHJvZmlsZUZvcm1OYW1lSW5wdXQ7XG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGluZm8ucHJvZmlsZUZvcm1Sb2xlSW5wdXQ7XG4gICAgdGhpcy5fYXZhdGFyLmFsdCA9IGBJbWFnZSBvZiAke2luZm8ucHJvZmlsZUZvcm1OYW1lSW5wdXR9YDtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gaW5mby5hdmF0YXJMaW5rO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbi8qKlxuICogQGNsYXNzIFBvcHVwV2l0aEltYWdlIGEgY2hpbGQgQGNsYXNzIG9mIFBvcHVwLlxuICogVGhpcyBjbGFzcyBoYXMgdG8gY2hhbmdlIHRoZSBAcGFyZW50IG9wZW4oKSBAbWV0aG9kLlxuICogVGhlIEBtZXRob2Qgb3BlbigpIG9mIHRoZSBQb3B1cFdpdGhJbWFnZSBAY2xhc3MsIGFkZHMgYW4gaW1hZ2UgdG8gdGhlIHBvcHVwXG4gKiBhbmQgdGhlIGNvcnJlc3BvbmRpbmcgaW1hZ2Ugc3JjIGF0dHJpYnV0ZSBhbG9uZyB3aXRoIGEgY2FwdGlvbiBmb3IgdGhlIGltYWdlLlxuICpcbiAqIFB1dHMgXCJuYW1lXCIgZnJvbSBAYXJndW1lbnRzIHRvIHRoZSBcIi5wb3B1cF9fY2FwdGlvblwiIHNlbGVjdG9yXG4gKiBmaW5kIGltYWdlIGJ5IHRoZSBwb3B1cF9faW1hZ2VcIiBzZWxlY3RvciBzZXQgXCJzcmNcIiBhbmQgXCJhbHRcIiBmb3IgaXRcbiAqICBjYWxsIEBjbGFzcyBzdXBlci5vcGVuLCBpdCB3aWxsIGNhbGwgdGhlIG9yaWdpbmFsIEBtZXRob2QgZnJvbSBvcmlnaW5hbCBAY2xhc3MgUG9wdXBcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3ByZXZpZXdQb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5wb3B1cF9fcHJldmlldy1pbWFnZVwiXG4gICAgKTtcbiAgICB0aGlzLl9wcmV2aWV3UG9wdXBEZXNjcmlwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2Rlc2NyaXB0aW9uXCJcbiAgICApO1xuICB9XG4gIG9wZW4gPSAobGlua1BsYWNlLCBuYW1lUGxhY2UpID0+IHtcbiAgICB0aGlzLl9wcmV2aWV3UG9wdXBJbWFnZS5zcmMgPSBsaW5rUGxhY2U7XG4gICAgdGhpcy5fcHJldmlld1BvcHVwSW1hZ2UuYWx0ID0gYFBpY3R1cmUgb2YgJHtuYW1lUGxhY2V9YDtcbiAgICB0aGlzLl9wcmV2aWV3UG9wdXBEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWVQbGFjZTtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfTtcbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZVRyYXNoQnV0dG9uQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJ0aGlzIiwiX2NhcmRUZW1wbGF0ZSIsImNsb25lTm9kZSIsIl9jYXJkU2VsZWN0b3IiLCJfaWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX3VzZXJJZCIsInVzZXJfaWQiLCJfbGlrZXNDb3VudCIsImxpa2VzIiwibGVuZ3RoIiwiX2xpa2VzTGlzdCIsImNvbnRlbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZVRyYXNoQnV0dG9uQ2xpY2siLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VCdXR0b25DbGljayIsIl9uYW1lIiwibmFtZVBsYWNlIiwiX2xpbmsiLCJsaW5rUGxhY2UiLCJfYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRMaWtlQnV0dG9uRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiX2NhcmRUcmFzaEJ1dHRvbkVsZW1lbnQiLCJfY2FyZEltYWdlRWxlbWVudCIsImdldElzTGlrZWQiLCJfaXNMaWtlZCIsInVwZGF0ZUxpa2VzIiwiX3JlbmRlckxpa2VzIiwic29tZSIsInBlcnNvbiIsImxpa2VzQ291bnQiLCJfY2FyZExpa2VzQ291bnRlckVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiX2dldFRlbXBsYXRlIiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJyZW1vdmVDYXJkIiwiY29uZmlnIiwiZm9ybUVsIiwiX3RvZ2dsZUJ1dHRvbiIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXQiLCJf0YFoZWNrSW5wdXRWYWxpZGl0eSIsImVycm9yU3BhbiIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfY29uZmlnIiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfaGFzVmFsaWRJbnB1dHMiLCJkaXNhYmxlZCIsImV2ZXJ5IiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJyZXNldCIsImRlZmF1bHRGb3JtQ29uZmlnIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInBvcHVwT3BlbkVkaXRQcm9maWxlQnV0dG9uIiwiZG9jdW1lbnQiLCJuZXdDYXJkQnV0dG9uRWxlbWVudCIsInBvcHVwT3BlbkVkaXRBdmF0YXJMaW5rIiwibmFtZUlucHV0Iiwicm9sZUVsZW1lbnRTZWxlY3RvciIsInJvbGVJbnB1dCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbnB1dHNBcnJheSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJnZXRQb3B1cEZvcm0iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsImNhcmRUZW1wbGF0ZUVsZW1lbnQiLCJ1c2VySWQiLCJyZW5kZXJDYXJkIiwiY2FyZCIsImltYWdlUG9wdXAiLCJjb25maXJtTW9kYWwiLCJzZXRBY3Rpb24iLCJhcGkiLCJkZWxldGVDYXJkIiwidGhlbiIsInJlcyIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImRpc0xpa2VDYXJkIiwibGlrZUNhcmQiLCJiYXNlVXJsIiwiaGVhZGVycyIsImFzeW5jIiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsIl9jdXN0b21GZXRjaCIsImdldFVzZXJJbmZvIiwic2V0QXZhdGFyTGluayIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXZhdGFyIiwic2V0VXNlckluZm8iLCJjcmVhdGVDYXJkIiwiY2FyZElkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRMaXN0U2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsImVsZW1lbnQiLCJjb250YWluZXIiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInVzZXJJbmZvIiwicHJvZmlsZUZvcm1OYW1lSW5wdXQiLCJwcm9maWxlRm9ybVJvbGVJbnB1dCIsImFib3V0IiwiYXZhdGFyTGluayIsImFsbCIsImNhcmREYXRhIiwidXNlckRhdGEiLCJjYXJkcyIsImVudHJ5IiwiY3JlYXRlZEF0IiwibGluayIsInB1c2giLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVTZWxlY3RvciIsIl9qb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhciIsImpvYiIsImluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZENhcmRQb3B1cCIsImVkaXRBdmF0YXJQb3B1cCIsImF2YXRhckRhdGEiLCJfcHJldmlld1BvcHVwSW1hZ2UiLCJfcHJldmlld1BvcHVwRGVzY3JpcHRpb24iLCJhY3Rpb24iLCJfaGFuZGxlU3VibWl0IiwiYWRkQ2FyZEZvcm0iLCJGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm0iLCJlZGl0QXZhdGFyRm9ybSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=