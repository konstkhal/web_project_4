!function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class t{constructor(t,n,i){e(this,"_getTemplate",(()=>this._cardTemplate.cloneNode(!0))),e(this,"_handleLikeButtonClick",(e=>{e.target.classList.toggle("photo-grid__like-button_active")})),e(this,"_handleTrashButtonClick",(()=>{this._element.remove(),this._element=null})),this._cardSelector=n,this._cardTemplate=this._cardSelector.content.querySelector(".photo-grid__item"),this._handleCardClick=i,this._name=t.namePlace,this._link=t.linkPlace,this._alt="Picture of ".concat(t.namePlace)}_setEventListeners(){this._cardLikeButtonElement.addEventListener("click",this._handleLikeButtonClick),this._cardTrashButtonElement.addEventListener("click",this._handleTrashButtonClick),this._cardImageElement.addEventListener("click",this._handleCardClick)}generateCard(){return this._element=this._getTemplate(),this._cardTitleElement=this._element.querySelector(".photo-grid__title"),this._cardImageElement=this._element.querySelector(".photo-grid__image"),this._cardLikeButtonElement=this._element.querySelector(".photo-grid__like-button"),this._cardTrashButtonElement=this._element.querySelector(".photo-grid__delete-button"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._element}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=class{constructor(e,t){n(this,"_setEventListeners",(()=>{this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._сheckInputValidity(e),this._toggleButton()}))}))})),n(this,"_showInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._config.errorClass),e.classList.add(this._config.inputErrorClass)})),n(this,"_hideInputError",(e=>{const t=this._element.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._config.errorClass),e.classList.remove(this._config.inputErrorClass)})),n(this,"_сheckInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),this._config={...e},this._element=t,this._buttonElement=this._element.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._element.querySelectorAll(this._config.inputSelector))}_toggleButton(){this._hasValidInputs()?this._buttonElement.disabled=!1:this._buttonElement.disabled=!0}_hasValidInputs(){return this._inputList.every((e=>!0===e.validity.valid))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._element.reset(),this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButton()}};const s={inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"button_blocked",inputErrorClass:"form__input-error",errorClass:"form__input-error_visible"},r=document.querySelector(".profile__link-change"),o=document.querySelector(".profile__link-add"),l=document.querySelector(".form__input_type_name"),a=".profile__role",c=(document.querySelector(a),document.querySelector(".form__input_type_role"));document.querySelector(".form__input_type_image-title"),document.querySelector(".form__input_type_image-link");class u{constructor(e){var t,n;n=e=>{"Escape"===e.key&&(e.preventDefault(),this.close())},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this._popupElement=document.querySelector(e)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}}class p extends u{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector("form"),this.handleFormSubmit=t,this._inputsArray=[...this._popupForm.querySelectorAll(".form__input")]}getPopupForm(){return this._popupForm}_getInputValues(){const e={};return this._inputsArray.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this.handleFormSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._popupForm.reset()}}const _=document.querySelector("#card-template"),h=e=>new t(e,_,(()=>{v.open(e.linkPlace,e.namePlace)})).generateCard(),d=new class{constructor(e,t){let{items:n,renderer:i}=e;var s,r;r=e=>{this.container.prepend(e)},(s="addItem")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this.initialItems=n,this.renderer=i,this.container=document.querySelector(t),this.renderItems()}renderItems(){this.initialItems.forEach((e=>{this.addItem(this.renderer(e))}))}}({items:[{namePlace:"Yosemite Valley",linkPlace:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{namePlace:"Lake Louise",linkPlace:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{namePlace:"Bald Mountains",linkPlace:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{namePlace:"Latemar",linkPlace:"https://code.s3.yandex.net/web-code/latemar.jpg"},{namePlace:"Vanoise National Park",linkPlace:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{namePlace:"Lago di Braies",linkPlace:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:h},".photo-grid__list"),m=new class{constructor(e,t){return this._nameSelector=e,this._jobSelector=t,this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.profileFormNameInput,this._jobElement.textContent=e.profileFormRoleInput}}(".profile__name",a),g=new p(".popup_type_edit-profile",(function(e){m.setUserInfo(e)})),E=new p(".popup_type_new-card",(function(e){d.addItem(h(e))})),v=new class extends u{constructor(e){var t,n;super(e),n=(e,t)=>{console.log(e),this._previewPopupImage.src=e,this._previewPopupImage.alt="Picture of ".concat(t),this._previewPopupDescription.textContent=t,super.open()},(t="open")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this.open=n,this._previewPopupImage=this._popupElement.querySelector(".popup__preview-image"),this._previewPopupDescription=this._popupElement.querySelector(".popup__description")}}(".popup_type_preview"),b=new i(s,E.getPopupForm()),y=new i(s,g.getPopupForm());b.enableValidation(),y.enableValidation(),v.setEventListeners(),g.setEventListeners(),E.setEventListeners(),r.addEventListener("click",(()=>{const{name:e,job:t}=m.getUserInfo();g.open(),y.resetValidation(),l.value=e,c.value=t})),o.addEventListener("click",(()=>{E.open(),b.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWMsSUFBSUMsRUFDdEI1RCxFQUNBc0QsRUFBYS9CLGdCQUVUc0MsRUFBVyxJQUFJRCxFQUNuQjVELEVBQ0FxRCxFQUFpQjlCLGdCQUduQm9DLEVBQVkvRCxtQkFDWmlFLEVBQVNqRSxtQkFLVGtDLEVBQVdqQixvQkFFWHdDLEVBQWlCeEMsb0JBRWpCeUMsRUFBYXpDLG9CQU1iWCxFQUEyQjVDLGlCQUFpQixTQUFTLEtBQ25ELE1BQU0sS0FBRW9FLEVBQUYsSUFBUXdCLEdBQVFSLEVBQVNPLGNBRS9CSSxFQUFpQnRDLE9BQ2pCOEMsRUFBUy9ELGtCQUNUTyxFQUFVc0IsTUFBUUQsRUFDbEJuQixFQUFVb0IsTUFBUXVCLEtBRXBCOUMsRUFBcUI5QyxpQkFBaUIsU0FBUyxLQUM3Q2dHLEVBQWF2QyxPQUNiNEMsRUFBWTdELHFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY2FyZHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKiBUcmFuc2Zvcm1pbmcgdGhlIENhcmQgQ2xhc3NcclxuICogIENvbm5lY3QgdGhlIENhcmQgY2xhc3MgdG8gdGhlIHBvcHVwLlxyXG4gKiBNYWtlIENhcmQgdGFrZSB0aGUgaGFuZGxlQ2FyZENsaWNrKCkgZnVuY3Rpb24gaW50byB0aGUgY29uc3RydWN0b3IuXHJcbiAqIFdoZW4gdGhlIHVzZXIgY2xpY2tzIG9uIHRoZSBjYXJkLFxyXG4gKiB0aGlzIGZ1bmN0aW9uIHdpbGwgb3BlbiB0aGUgcG9wdXAgd2l0aCBhbiBpbWFnZVxyXG4gKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrKSB7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7IC8vdGVtcGxhdGUgc2VsZWN0b3JcclxuXHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGUgPVxyXG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3IuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWdyaWRfX2l0ZW1cIik7IC8vIHNlbGVjdGluZyBjYXJkIHRlbXBsYXRlIGVsZW1lbnRcclxuXHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZVBsYWNlO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGlua1BsYWNlO1xyXG4gICAgdGhpcy5fYWx0ID0gYFBpY3R1cmUgb2YgJHtkYXRhLm5hbWVQbGFjZX1gO1xyXG5cclxuICAgIC8vIHNlbGVjdCBjYXJkIGFuZCBjYXJkIGVsZW1lbnQgcGFydHNcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlID0gKCkgPT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9oYW5kbGVycyBzZXR0ZWQgaGVyZVxyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBcImNsaWNrXCIsXHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b25DbGlja1xyXG4gICAgKTtcclxuICAgIHRoaXMuX2NhcmRUcmFzaEJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgXCJjbGlja1wiLFxyXG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaEJ1dHRvbkNsaWNrXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uQ2xpY2sgPSAoZXZlbnQpID0+IHtcclxuICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwicGhvdG8tZ3JpZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVUcmFzaEJ1dHRvbkNsaWNrID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gIH07XHJcblxyXG4gIC8qICBfaGFuZGxlQ2FyZEltYWdlQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xyXG4gIH07ICovXHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1ncmlkX190aXRsZVwiKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWdyaWRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5waG90by1ncmlkX19saWtlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZFRyYXNoQnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucGhvdG8tZ3JpZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbCkge1xuICAgIHRoaXMuX2NvbmZpZyA9IHsgLi4uY29uZmlnIH07XG5cbiAgICB0aGlzLl9lbGVtZW50ID0gZm9ybUVsOyAvL215IGZvcm0gaXMgaGVyZVxuXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dHMoKSkge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBfaGFzVmFsaWRJbnB1dHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkID09PSB0cnVlKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5f0YFoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XG4gICAgY29uc3QgZXJyb3JTcGFuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcblxuICAgIGVycm9yU3Bhbi50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yU3Bhbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IGVycm9yU3BhbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XG5cbiAgICBlcnJvclNwYW4udGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yU3Bhbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICB9O1xuXG4gIF/RgWhlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0KSA9PiB7XG4gICAgaWYgKGlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9XG4gIH07XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAvL1B1YmxpYyBpbml0IGVudHJ5IHBvaW50IG9mIHRoZSBjbGFzc1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVzZXQoKTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9KTtcbiAgICAvLyB0aGlzLl9lbGVtZW50LnJlc2V0KCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNvbnN0IGRlZmF1bHRGb3JtQ29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImJ1dHRvbl9ibG9ja2VkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBwb3B1cE9wZW5FZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fbGluay1jaGFuZ2VcIlxyXG4pO1xyXG5jb25zdCBuZXdDYXJkQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbGluay1hZGRcIik7XHJcblxyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgIElOSVRJQUwgdmFyaWFibGVzIGZvciBwcm9maWxlIGVkaXQgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5jb25zdCBuYW1lRWxlbWVudFNlbGVjdG9yID0gXCIucHJvZmlsZV9fbmFtZVwiO1xyXG4vL2NvbnN0IG5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxlbWVudFNlbGVjdG9yKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF90eXBlX25hbWVcIik7IC8vcG9wdXAgZm9ybVxyXG5jb25zdCByb2xlRWxlbWVudFNlbGVjdG9yID0gXCIucHJvZmlsZV9fcm9sZVwiO1xyXG5jb25zdCByb2xlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iocm9sZUVsZW1lbnRTZWxlY3Rvcik7XHJcbmNvbnN0IHJvbGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9yb2xlXCIpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICBQb3B1cCBBREQgY2FyZCBmdW5jdGlvbmFsaXR5ICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuY29uc3QgdXNlcklucHV0SW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuZm9ybV9faW5wdXRfdHlwZV9pbWFnZS10aXRsZVwiXHJcbik7XHJcbmNvbnN0IHVzZXJJbnB1dEltYWdlTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuZm9ybV9faW5wdXRfdHlwZV9pbWFnZS1saW5rXCJcclxuKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICBFc2NhcGUga2V5IHZhbHVlIENPTlNUICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuY29uc3QgRVNDX0JVVFRPTiA9IFwiRXNjYXBlXCI7XHJcblxyXG5leHBvcnQge1xyXG4gIEVTQ19CVVRUT04sXHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgcG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgbmV3Q2FyZEJ1dHRvbkVsZW1lbnQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIHJvbGVJbnB1dCxcclxuICBuYW1lRWxlbWVudFNlbGVjdG9yLFxyXG4gIHJvbGVFbGVtZW50U2VsZWN0b3IsXHJcbiAgdXNlcklucHV0SW1hZ2VUaXRsZSxcclxuICB1c2VySW5wdXRJbWFnZUxpbmssXHJcbn07XHJcbiIsImltcG9ydCB7IEVTQ19CVVRUT04gfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG4vKipcclxuICogQGNsYXNzIFBvcHVwIG9wZW5zIGFuZCBjbG9zZXMgdGhlIHBvcHVwIHdpbmRvd1xyXG4gKiBhcyBwZXIgdGhlIGZvbGxvd2luZyByZXF1aXJlbWVudHM6XHJcbiAqIEBjb25zdHJ1Y3RvciBoYXMgYSBzaW5nbGVcclxuICogQHBhcmFtIHBvcHVwU2VsZWN0b3IgaXQgaXMgdGhlIHBvcHVwIHNlbGVjdG9yLlxyXG4gKiBJdCBzdG9yZXMgdGhlXHJcbiAqIHB1YmxpYyBAbWV0aG9kIG9wZW4oKSB0aGF0IHdpbGwgb3BlbiB0aGUgcG9wdXAuXHJcbiAqIHB1YmxpYyBAbWV0aG9kIGNsb3NlKCkgdGhhdCB3aWxsIGNsb3NlIHRoZSBwb3B1cC5cclxuICogSXQgc3RvcmVzIGFcclxuICogcHJpdmF0ZSBAbWV0aG9kIF9oYW5kbGVFc2NDbG9zZSgpIHRoYXQgcHJldmVudHMgZGVmYXVsdFxyXG4gKiBhbmQgc3RvcmVzIHRoZSBsb2dpYyBmb3IgICogY2xvc2luZyB0aGUgcG9wdXAgYnkgcHJlc3NpbmcgdGhlIEVzYyBrZXkuXHJcbiAqIEl0IHN0b3JlcyBhXHJcbiAqIHB1YmxpYyBAbWV0aG9kIHNldEV2ZW50TGlzdGVuZXJzKCkgdGhhdCBhZGRzIGEgY2xpY2sgZXZlbnQgbGlzdGVuZXJcclxuICogIHRvIHRoZSBjbG9zZSBpY29uIG9mIHRoZSBwb3B1cC4gVGhlIG1vZGFsIHdpbmRvdyBzaG91bGQgYWxzb1xyXG4gKiBjbG9zZSB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSBzaGFkZWQgYXJlYSBhcm91bmQgdGhlIGZvcm0uXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAvLyB0aGlzLnNldEV2ZW50TGlzdGVuZXJzID0gdGhpcy5zZXRFdmVudExpc3RlbmVycy5iaW5kKHRoaXMpO1xyXG4gICAgLy9SZXNlcnZlZCBmb3IgZnV0dXJlIHVzZTogc29sdXRpb24gZm9yIG5vdCBsb3NpbmcgY29udGV4XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlLWJ1dHRvblwiKVxyXG4gICAgICAgIC8vIHx8ICFldmVudC5jbG9zZXN0KFwicG9wdXBcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IEVTQ19CVVRUT04pIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG4vKipcclxuICogQ3JlYXRlIFBvcHVwV2l0aEZvcm0gYXMgYSBjaGlsZCBjbGFzcyBvZiBQb3B1cC5cclxuICogVGhlIFBvcHVwV2l0aEZvcm0gY2xhc3MgbXVzdCBjb21wbHkgd2l0aCB0aGUgZm9sbG93aW5nIHJlcXVpcmVtZW50czpcclxuICogSXQgdGFrZXMgdHdvIGFyZ3VtZW50czpcclxuICogdGhlIHBvcHVwIHNlbGVjdG9yLFxyXG4gKiBhbmQgYSBjYWxsYmFjayBmdW5jdGlvblxyXG4gKiB3aGljaCBQb3B1cFdpdGhGb3JtIGNhbGxzIHdoZW4gdGhlIGZvcm3igJlzIHN1Ym1pdCBldmVudCBmaXJlcy5cclxuICogSXQgc3RvcmVzIGEgcHJpdmF0ZSBtZXRob2QgbmFtZWQgX2dldElucHV0VmFsdWVzKCksXHJcbiAqIHdoaWNoIGNvbGxlY3RzIGRhdGEgZnJvbSBhbGwgdGhlIGlucHV0IGZpZWxkcyBhbmQgcmV0dXJucyB0aGF0IGRhdGEgYXMgYW4gb2JqZWN0LlxyXG4gKiBJdCBtb2RpZmllcyB0aGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBwYXJlbnQgbWV0aG9kLlxyXG4gKiBUaGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob2Qgb2YgdGhlIFBvcHVwV2l0aEZvcm0gY2xhc3NcclxuICogIGhhcyB0byBhZGQgdGhlIHN1Ym1pdCBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtMFxyXG4gKiAgYW5kIHRoZSBjbGljayBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cclxuICogSXQgbW9kaWZpZXMgdGhlIGNsb3NlKCkgcGFyZW50IG1ldGhvZFxyXG4gKiBpbiBvcmRlciB0byByZXNldCB0aGUgZm9ybSBvbmNlIHRoZSBwb3B1cCBpcyBjbG9zZWQuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XHJcblxyXG4gICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0c0FycmF5ID0gWy4uLnRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpXTtcclxuICB9XHJcblxyXG4gIGdldFBvcHVwRm9ybSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9wb3B1cEZvcm07XHJcbiAgfVxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dHNBcnJheS5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNpeCBpbml0aWFsIGNhcmRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lUGxhY2U6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rUGxhY2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lUGxhY2U6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbmtQbGFjZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWVQbGFjZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGlua1BsYWNlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZVBsYWNlOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbmtQbGFjZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZVBsYWNlOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGlua1BsYWNlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lUGxhY2U6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbmtQbGFjZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFpbiBzY3JpcHRzIGZpbGUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbXBvcnRzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5cclxuaW1wb3J0IHsgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NhcmRzLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgZGVmYXVsdEZvcm1Db25maWcsXHJcbiAgcG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgbmV3Q2FyZEJ1dHRvbkVsZW1lbnQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIHJvbGVJbnB1dCxcclxuICBuYW1lRWxlbWVudFNlbGVjdG9yLFxyXG4gIHJvbGVFbGVtZW50U2VsZWN0b3IsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JhcHBlcnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbi8vIHNlbGVjdGluZyBjYXJkIHRlbXBsYXRlIGVsZW1lbnRcclxuY29uc3QgY2FyZFRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuXHJcbi8qKlxyXG4gKiBAZnVuY3Rpb24gcmVuZGVyQ2FyZCBjcmVhdGVzIENhcmQgb2JqZWN0IHdpdGggZGF0YSBwYXJhbSBhbmQgd2l0aCB0ZW1wbGF0ZSBoYXJkY29kZWRcclxuICogQHBhcmFtIHthcnJheX0gZGF0YSBjb250YWlucyB7bmFtZSwgbGlua31cclxuICogQHBhcmFtIHt0ZXh0fSBjYXJkVGVtcGxhdGVFbGVtZW50IGNvbnRhaW5zIHRleHQgaWQgb2YgY2FyZCBlbGVtZW50IHRvIGJlIGNsb25lZFxyXG4gKiBAcGFyYW0ge0Fycm93IGZ1bmN0aW9ufSBpcyBjYXJkQ2xpY2sgaGFuZGxlciBmb3Igb3BlbmluZyBQb3B1cFdpdGhJbWFnZVxyXG4gKi9cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGRhdGEsIGNhcmRUZW1wbGF0ZUVsZW1lbnQsICgpID0+IHtcclxuICAgIGltYWdlUG9wdXAub3BlbihkYXRhLmxpbmtQbGFjZSwgZGF0YS5uYW1lUGxhY2UpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufTtcclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgICAgICBPYmplY3RzIGNyZWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyoqXHJcbiAqIE5ld2x5IGNyZWF0ZWQgQGNvbnN0YW50IGNhcmRMaXN0U2VjdGlvbiBjb250YWlucyBTZWN0aW9uIEBvYmplY3RcclxuICpcclxuICpcclxuICovXHJcblxyXG5jb25zdCBjYXJkTGlzdFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7IGl0ZW1zOiBpbml0aWFsQ2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sXHJcbiAgXCIucGhvdG8tZ3JpZF9fbGlzdFwiXHJcbik7XHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICBQb3B1cCBGb3JtIEhhbmRsZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChkYXRhKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld0NhcmRGb3JtU3VibWl0KGRhdGEpIHtcclxuICBjYXJkTGlzdFNlY3Rpb24uYWRkSXRlbShyZW5kZXJDYXJkKGRhdGEpKTtcclxufVxyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8obmFtZUVsZW1lbnRTZWxlY3Rvciwgcm9sZUVsZW1lbnRTZWxlY3Rvcik7XHJcblxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXBfdHlwZV9lZGl0LXByb2ZpbGVcIixcclxuICBoYW5kbGVFZGl0Rm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX25ldy1jYXJkXCIsXHJcbiAgaGFuZGxlTmV3Q2FyZEZvcm1TdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9wcmV2aWV3XCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBkZWZhdWx0Rm9ybUNvbmZpZyxcclxuICBhZGRDYXJkUG9wdXAuZ2V0UG9wdXBGb3JtKClcclxuKTtcclxuY29uc3QgZWRpdEZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBkZWZhdWx0Rm9ybUNvbmZpZyxcclxuICBlZGl0UHJvZmlsZVBvcHVwLmdldFBvcHVwRm9ybSgpXHJcbik7XHJcblxyXG5hZGRDYXJkRm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmVkaXRGb3JtLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbi8qICAgICAgICAgICAgICAgICAgICAgICAgIFBvcHVwIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXHJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuLyogICAgICAgICAgICAgICAgICAgT3BlbiBQb3B1cCBCdXR0b25zIGxpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cclxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbnBvcHVwT3BlbkVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBqb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcblxyXG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xyXG4gIGVkaXRGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgcm9sZUlucHV0LnZhbHVlID0gam9iO1xyXG59KTtcclxubmV3Q2FyZEJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gIGFkZENhcmRGb3JtLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZSB0aGUgU2VjdGlvbiBjbGFzcyBmb3IgcmVuZGVyaW5nIGEgbGlzdCBvZiBlbGVtZW50cyBvbiBhIHBhZ2VcclxuICogYWNjb3JkaW5nIHRvIHRoZSBmb2xsb3dpbmcgcmVxdWlyZW1lbnRzOlxyXG4gKiBJdCBoYXMgYW4gb2JqZWN0IHdpdGggdHdvIHByb3BlcnRpZXMgKGl0ZW1zIGFuZCByZW5kZXJlcilcclxuICogYXMgdGhlIGZpcnN0IHBhcmFtZXRlciBvZiB0aGUgY29uc3RydWN0b3IuXHJcbiAqIFRoZSBpdGVtcyBwcm9wZXJ0eSBzZXJ2ZXMgYXMgYW4gYXJyYXkgb2YgZGF0YSxcclxuICogd2hpY2ggeW91IG5lZWQgdG8gYWRkIG9uIGEgcGFnZSB3aGVuIGluaXRpYWxpemluZyB0aGUgY2xhc3MuXHJcbiAqIFRoZSByZW5kZXJlciBwcm9wZXJ0eSBpcyBhXHJcbiAqIGZ1bmN0aW9uIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyBhbmQgcmVuZGVyaW5nIGRhdGEgb24gYSBwYWdlLlxyXG4gKiBUaGUgc2Vjb25kIHBhcmFtZXRlciBzaG91bGQgYmUgYSBDU1MgY2xhc3Mgc2VsZWN0b3JcclxuICogd2hlcmUgeW91J2xsIGFkZCB0aGUgY2FyZCBlbGVtZW50cy5cclxuICogSXQgc3RvcmVzIGEgcHVibGljIG1ldGhvZCB0aGF0IHJlbmRlcnMgYWxsIGVsZW1lbnRzIG9uIHRoZSBwYWdlLlxyXG4gKiBUaGUgcmVuZGVyZXIoKSBmdW5jdGlvbiB3aWxsIHJlbmRlciBlYWNoIGVsZW1lbnQgb24gYSBwYWdlLlxyXG4gKiBJdCBzdG9yZXMgYSBwdWJsaWMgbWV0aG9kIG5hbWVkIGFkZEl0ZW0oKVxyXG4gKiB0aGF0IHRha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lci5cclxuICogVGhlIFNlY3Rpb24gY2xhc3MgZG9lc24ndCBoYXZlIG1hcmt1cC5cclxuICogSXQgcmVjZWl2ZXMgbWFya3VwIHRocm91Z2ggdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIGFuZCBpbnNlcnRzIGl0IGluIHRoZSBjb250YWluZXJcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLmluaXRpYWxJdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIHRoaXMucmVuZGVySXRlbXMoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5pbml0aWFsSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLmFkZEl0ZW0odGhpcy5yZW5kZXJlcihpdGVtKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0gPSAoZWxlbWVudCkgPT4ge1xyXG4gICAgLy8gY29uc29sZS5sb2coZWxlbWVudCk7XHJcbiAgICB0aGlzLmNvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH07XHJcbn1cclxuIiwiLyoqVGhlIFVzZXJJbmZvIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvclxyXG4gKiByZW5kZXJpbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIgb24gdGhlIHBhZ2UuXHJcbiAqIFRoaXMgY2xhc3Mgc2hvdWxkOlxyXG4gKiBUYWtlIGFuIG9iamVjdCB3aXRoIHRoZSBzZWxlY3RvcnMgb2YgdHdvIGVsZW1lbnRzIGludG8gdGhlIGNvbnN0cnVjdG9yOlxyXG4gKiBvbmUgY29udGFpbmluZyB0aGUgdXNlcidzIG5hbWUsXHJcbiAqIGFuZCBhbm90aGVyIGNvbnRhaW5pbmcgdGhlIHVzZXIncyBqb2IuXHJcbiAqIFN0b3JlIGEgcHVibGljIG1ldGhvZCBuYW1lZCBnZXRVc2VySW5mbygpLFxyXG4gKiB3aGljaCByZXR1cm5zIGFuIG9iamVjdCB3aXRoIGluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VyLlxyXG4gKiBUaGlzIG1ldGhvZCB3aWxsIGJlIGhhbmR5IGZvciBjYXNlcyB3aGVuIGl0J3MgbmVjZXNzYXJ5IHRvIGRpc3BsYXkgdGhlIHVzZXIgZGF0YSBpbiB0aGUgb3BlbiBmb3JtLlxyXG4gKiBTdG9yZSBhIHB1YmxpYyBtZXRob2QgbmFtZWQgc2V0VXNlckluZm8oKSxcclxuICogd2hpY2ggdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cclxuICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fbmFtZVNlbGVjdG9yID0gbmFtZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5fam9iU2VsZWN0b3IgPSBqb2JTZWxlY3RvcjtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oaW5mbykge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbmZvW1wicHJvZmlsZUZvcm1OYW1lSW5wdXRcIl07XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gaW5mb1tcInByb2ZpbGVGb3JtUm9sZUlucHV0XCJdO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbi8qKlxyXG4gKiBAY2xhc3MgUG9wdXBXaXRoSW1hZ2UgYSBjaGlsZCBAY2xhc3Mgb2YgUG9wdXAuXHJcbiAqIFRoaXMgY2xhc3MgaGFzIHRvIGNoYW5nZSB0aGUgQHBhcmVudCBvcGVuKCkgQG1ldGhvZC5cclxuICogVGhlIEBtZXRob2Qgb3BlbigpIG9mIHRoZSBQb3B1cFdpdGhJbWFnZSBAY2xhc3MsIGFkZHMgYW4gaW1hZ2UgdG8gdGhlIHBvcHVwXHJcbiAqIGFuZCB0aGUgY29ycmVzcG9uZGluZyBpbWFnZSBzcmMgYXR0cmlidXRlIGFsb25nIHdpdGggYSBjYXB0aW9uIGZvciB0aGUgaW1hZ2UuXHJcbiAqXHJcbiAqIFB1dHMgXCJuYW1lXCIgZnJvbSBAYXJndW1lbnRzIHRvIHRoZSBcIi5wb3B1cF9fY2FwdGlvblwiIHNlbGVjdG9yXHJcbiAqIGZpbmQgaW1hZ2UgYnkgdGhlIHBvcHVwX19pbWFnZVwiIHNlbGVjdG9yIHNldCBcInNyY1wiIGFuZCBcImFsdFwiIGZvciBpdFxyXG4gKiAgY2FsbCBAY2xhc3Mgc3VwZXIub3BlbiwgaXQgd2lsbCBjYWxsIHRoZSBvcmlnaW5hbCBAbWV0aG9kIGZyb20gb3JpZ2luYWwgQGNsYXNzIFBvcHVwXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wcmV2aWV3UG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wb3B1cF9fcHJldmlldy1pbWFnZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcHJldmlld1BvcHVwRGVzY3JpcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX2Rlc2NyaXB0aW9uXCJcclxuICAgICk7XHJcbiAgfVxyXG4gIG9wZW4gPSAobGlua1BsYWNlLCBuYW1lUGxhY2UpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGxpbmtQbGFjZSk7XHJcblxyXG4gICAgdGhpcy5fcHJldmlld1BvcHVwSW1hZ2Uuc3JjID0gbGlua1BsYWNlO1xyXG4gICAgdGhpcy5fcHJldmlld1BvcHVwSW1hZ2UuYWx0ID0gYFBpY3R1cmUgb2YgJHtuYW1lUGxhY2V9YDtcclxuICAgIHRoaXMuX3ByZXZpZXdQb3B1cERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gbmFtZVBsYWNlO1xyXG5cclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwidGhpcyIsIl9jYXJkVGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJldmVudCIsInRhcmdldCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9lbGVtZW50IiwicmVtb3ZlIiwiX2NhcmRTZWxlY3RvciIsImNvbnRlbnQiLCJxdWVyeVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9uYW1lIiwibmFtZVBsYWNlIiwiX2xpbmsiLCJsaW5rUGxhY2UiLCJfYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRMaWtlQnV0dG9uRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUJ1dHRvbkNsaWNrIiwiX2NhcmRUcmFzaEJ1dHRvbkVsZW1lbnQiLCJfaGFuZGxlVHJhc2hCdXR0b25DbGljayIsIl9jYXJkSW1hZ2VFbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImNvbmZpZyIsImZvcm1FbCIsIl90b2dnbGVCdXR0b24iLCJfaW5wdXRMaXN0IiwiZm9yRWFjaCIsImlucHV0IiwiX9GBaGVja0lucHV0VmFsaWRpdHkiLCJlcnJvclNwYW4iLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiYWRkIiwiX2NvbmZpZyIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2hhc1ZhbGlkSW5wdXRzIiwiZGlzYWJsZWQiLCJldmVyeSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsInJlc2V0IiwiZGVmYXVsdEZvcm1Db25maWciLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwicG9wdXBPcGVuRWRpdFByb2ZpbGVCdXR0b24iLCJkb2N1bWVudCIsIm5ld0NhcmRCdXR0b25FbGVtZW50IiwibmFtZUlucHV0Iiwicm9sZUVsZW1lbnRTZWxlY3RvciIsInJvbGVJbnB1dCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY29udGFpbnMiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2lucHV0c0FycmF5IiwiZ2V0UG9wdXBGb3JtIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJuYW1lIiwidmFsdWUiLCJjYXJkVGVtcGxhdGVFbGVtZW50IiwicmVuZGVyQ2FyZCIsImltYWdlUG9wdXAiLCJjYXJkTGlzdFNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJlbGVtZW50IiwiY29udGFpbmVyIiwicHJlcGVuZCIsImluaXRpYWxJdGVtcyIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVTZWxlY3RvciIsIl9qb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImluZm8iLCJlZGl0UHJvZmlsZVBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwiY29uc29sZSIsImxvZyIsIl9wcmV2aWV3UG9wdXBJbWFnZSIsIl9wcmV2aWV3UG9wdXBEZXNjcmlwdGlvbiIsImFkZENhcmRGb3JtIiwiRm9ybVZhbGlkYXRvciIsImVkaXRGb3JtIl0sInNvdXJjZVJvb3QiOiIifQ==